
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Analyses morphom√©triques &#8212; M√©thodes en neurosciences cognitives</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'morphometrie';</script>
    <link rel="icon" href="_static/favicon.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="IRM fonctionnelle" href="irm_fonctionnelle.html" />
    <link rel="prev" title="Imagerie par r√©sonance magn√©tique" href="irm.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="M√©thodes en neurosciences cognitives - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="M√©thodes en neurosciences cognitives - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="cartes_cerebrales.html">Cartes c√©r√©brales</a></li>
<li class="toctree-l1"><a class="reference internal" href="irm.html">Imagerie par r√©sonance magn√©tique</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Analyses morphom√©triques</a></li>
<li class="toctree-l1"><a class="reference internal" href="irm_fonctionnelle.html">IRM fonctionnelle</a></li>
<li class="toctree-l1"><a class="reference internal" href="connectivite.html">Connectivit√© fonctionnelle</a></li>
<li class="toctree-l1"><a class="reference internal" href="irm_diffusion.html">IRM de diffusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="imagerie_optique.html">Imagerie optique</a></li>
<li class="toctree-l1"><a class="reference internal" href="tep.html">Tomographie par √©mission de positrons</a></li>
<li class="toctree-l1"><a class="reference internal" href="cartes_statistiques.html">Cartes statistiques</a></li>
<li class="toctree-l1"><a class="reference internal" href="reproductibilite.html">Reproductibilit√© et controverses</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/psy3018/notes_cours_psy3018" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/psy3018/notes_cours_psy3018/edit/main/methodes_neurocog/morphometrie.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/psy3018/notes_cours_psy3018/issues/new?title=Issue%20on%20page%20%2Fmorphometrie.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/morphometrie.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Analyses morphom√©triques</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objectifs-du-cours">Objectifs du cours</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#morphometrie">Morphom√©trie</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#volumetrie">Volum√©trie</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#segmentation-manuelle">Segmentation manuelle</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#segmentation-automatique">Segmentation automatique</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analyses-statistiques">Analyses statistiques</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#controle-de-qualite">Contr√¥le de qualit√©</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vbm">VBM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#densite-de-matiere-grise">Densit√© de mati√®re grise</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#segmentation">Segmentation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lissage">Lissage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Analyses statistiques</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Contr√¥le de qualit√©</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analyses-de-surface">Analyses de surface</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extraction-de-surface">Extraction de surface</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#epaisseur-surface-et-volume">√âpaisseur, surface et volume</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Analyses statistiques</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Contr√¥le de qualit√©</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercices">Exercices</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="analyses-morphometriques">
<span id="morphometrie-chapitre"></span><h1>Analyses morphom√©triques<a class="headerlink" href="#analyses-morphometriques" title="Link to this heading">#</a></h1>
<table>
  <tr>
    <td align="center">
      <a href="https://github.com/eddyfortier">
        <img src="https://avatars.githubusercontent.com/u/72314243?v=4?s=100" width="100px;" alt=""/>
        <br /><sub><b>Eddy Fortier</b></sub>
      </a>
      <br />
        <a title="Contenu">ü§î</a>
        <a title="R√©vision du texte">üëÄ</a>
    </td>
    <td align="center">
      <a href="https://github.com/me-pic">
        <img src="https://avatars.githubusercontent.com/u/77584086?v=4?s=100" width="100px;" alt=""/>
        <br /><sub><b>Marie-Eve Picard</b></sub>
      </a>
      <br />
        <a title="R√©vision du texte">üëÄ</a>
    </td>
    <td align="center">
      <a href="https://github.com/pbellec">
        <img src="https://avatars.githubusercontent.com/u/1670887?v=4?s=100" width="100px;" alt=""/>
        <br /><sub><b>Pierre bellec</b></sub>
      </a>
      <br />
        <a title="Contenu">ü§î</a>
        <a title="Quizz">‚ö†Ô∏è</a>
        <a title="R√©vision du texte">üëÄ</a>
        <a title="Code">üíª</a>
        <a title="Quiz">‚ö†Ô∏è</a>
    </td>
  </tr>
</table>
<section id="objectifs-du-cours">
<h2>Objectifs du cours<a class="headerlink" href="#objectifs-du-cours" title="Link to this heading">#</a></h2>
<p>Ce cours introduit diff√©rentes approches pour quantifier la morphologie du cerveau √† l‚Äôaide des donn√©es d‚Äôimagerie par r√©sonance magn√©tique anatomique. Il sera question dans ce chapitre de trois grandes approches d‚Äôanalyse:</p>
<ul class="simple">
<li><p>la <strong>volum√©trie</strong>, qui vise √† mesurer la taille d‚Äôune r√©gion c√©r√©brale;</p></li>
<li><p>la <strong>morphom√©trie bas√©e sur les voxels (<em>voxel-based morphometry</em> ou VBM)</strong>, qui vise √† mesurer le volume de mati√®re grise locale pour chaque voxel dans le cerveau;</p></li>
<li><p>les <strong>analyses de surface</strong>, qui exploitent la structure en ruban de la mati√®re grise pour mesurer l‚Äô√©paisseur et la surface corticale.</p></li>
</ul>
<p>On parlera √©galement d‚Äô√©tapes d‚Äôanalyse d‚Äôimages utiles pour l‚Äôensemble de ces techniques: le <strong>recalage</strong>, la <strong>segmentation</strong>, le <strong>lissage</strong> et le <strong>contr√¥le de qualit√©</strong>.</p>
</section>
<section id="morphometrie">
<h2>Morphom√©trie<a class="headerlink" href="#morphometrie" title="Link to this heading">#</a></h2>
<figure class="align-default" id="morphometrie-durer-fig">
<a class="reference internal image-reference" href="_images/morphometrie_durer.jpg"><img alt="_images/morphometrie_durer.jpg" src="_images/morphometrie_durer.jpg" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 21 </span><span class="caption-text">√âtude de D√ºrer sur les proportions du visage.
Image appartenant au domaine public, tir√©e de <a class="reference external" href="https://commons.wikimedia.org/wiki/File:Morpho_durer.JPG">wikimedia</a>.</span><a class="headerlink" href="#morphometrie-durer-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>En neurosciences, la <a class="reference external" href="https://fr.wikipedia.org/wiki/Morphom%C3%A9trie">morphom√©trie</a> est l‚Äô√©tude de la forme du cerveau et de ses structures.
Le terme morphom√©trie combine deux termes tir√©s du grec ancien: <em>morphos</em> (forme) et <em>m√©tron</em> (mesure).
La morphom√©trie est donc la ‚Äúmesure‚Äù de la ‚Äúforme‚Äù.
Pour mesurer la forme du cerveau, il est n√©cessaire de pouvoir observer clairement les d√©limitations neuroanatomiques.
L‚ÄôIRM anatomique nous donne un bon contraste entre mati√®re grise, mati√®re blanche et liquide c√©phalo-rachidien.
Combin√©e avec des outils automatiques d‚Äôanalyse d‚Äôimages, l‚ÄôIRM permet donc de r√©aliser des √©tudes de morphologie computationnelle.</p>
<figure class="align-default" id="ledig2018-fig">
<a class="reference internal image-reference" href="_images/ledig2018.webp"><img alt="_images/ledig2018.webp" src="_images/ledig2018.webp" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 22 </span><span class="caption-text">Cette figure illustre des diff√©rences morphologiques entre des individus pr√©sentant des profils cliniques diff√©rents: sans atteinte cognitive (haut), troubles l√©gers de la cognition (milieu), d√©mence de type Alzheimer (bas).
Par ailleurs, il est √©galement possible d‚Äôobserver des diff√©rences longitudinales au sein d‚Äôun m√™me individu (de gauche √† droite, visite initiale, suivi apr√®s deux ans, diff√©rence entre les deux images).
Figure tir√©e de <span id="id1">[<a class="reference internal" href="references.html#id13" title="Christian Ledig, Andreas Schuh, Ricardo Guerrero, Rolf A Heckemann, and Daniel Rueckert. Structural brain imaging in alzheimer's disease and mild cognitive impairment: biomarker analysis and shared morphometry database. Sci. Rep., 8(1):1‚Äì16, July 2018.">7</a>]</span>, sous licence CC-BY.</span><a class="headerlink" href="#ledig2018-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Comme le d√©montre la figure ci-haut, les √©tudes morphologiques IRM permettent de comparer des individus et des groupes.
De telles comparaisons peuvent nous informer sur l‚Äôeffet de l‚Äô√¢ge, ou bien encore l‚Äôeffet d‚Äôune l√©sion ou d‚Äôune maladie sur la forme du cerveau.</p>
</section>
<section id="volumetrie">
<h2>Volum√©trie<a class="headerlink" href="#volumetrie" title="Link to this heading">#</a></h2>
<section id="segmentation-manuelle">
<h3>Segmentation manuelle<a class="headerlink" href="#segmentation-manuelle" title="Link to this heading">#</a></h3>
<figure class="align-default" id="ashempour2019-fig">
<a class="reference internal image-reference" href="_images/ashempour2019.jpg"><img alt="_images/ashempour2019.jpg" src="_images/ashempour2019.jpg" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 23 </span><span class="caption-text">Cette figure illustre un protocole de segmentation manuelle de l‚Äôamygdale.
Vue coronale d‚Äôune segmentation manuelle de l‚Äôamygdale gauche (jaune) et droit (bleu) avant (gauche) et apr√®s (droite) avoir proc√©d√© aux corrections dans le plan coronal.
Figure tir√©e de <span id="id2">[<a class="reference internal" href="references.html#id14" title="Niloofar Hashempour, Jetro J Tuulari, Harri Merisaari, Kristian Lidauer, Iiris Luukkonen, Jani Saunavaara, Riitta Parkkola, Tuire L√§hdesm√§ki, Satu J Lehtola, Maria Keskinen, John D Lewis, Noora M Scheinin, Linnea Karlsson, and Hasse Karlsson. A novel approach for manual segmentation of the amygdala and hippocampus in neonate MRI. Front. Neurosci., 13:1025, September 2019.">8</a>]</span>, sous licence CC-BY.</span><a class="headerlink" href="#ashempour2019-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>La <strong>volum√©trie manuelle</strong> consiste √† d√©limiter visuellement une aire c√©r√©brale particuli√®re, comme l‚Äôhippocampe ou l‚Äôamygdale (voir <a class="reference internal" href="#ashempour2019-fig"><span class="std std-numref">Fig. 23</span></a>).
Cette approche n√©cessite du temps, car le contour des structures d‚Äôint√©r√™t doit √™tre dessin√© √† la main sur chaque coupe d‚ÄôIRM.
On commence d‚Äôabord par segmenter une structure dans un premier plan de coupe (par exemple, dans le plan axial), puis il faudra aller corriger cette segmentation dans les autres plans (par exemple, dans le plan sagittal, puis dans le plan coronal).</p>
<blockquote>
<div><p>Pour un rappel concernant les diff√©rents types de coupes du cerveau, veuillez vous r√©f√©rer au <a class="reference internal" href="cartes_cerebrales.html#coupes-tip"><span class="std std-ref">Chapitre 1: Cartes c√©r√©brales</span></a>.</p>
</div></blockquote>
<p>Afin de d√©terminer o√π une r√©gion c√©r√©brale se situe, ce type d‚Äôapproche n√©cessite √©galement un protocole de segmentation avec des crit√®res anatomiques clairs.
Pour certaines structures, comme pour l‚Äôhippocampe, il existe des protocoles d√©taill√©s (par exemple: <span id="id3">[<a class="reference internal" href="references.html#id12" title="Laura E M Wisse, Ana M Daugherty, Rosanna K Olsen, David Berron, Valerie A Carr, Craig E L Stark, Robert S C Amaral, Katrin Amunts, Jean C Augustinack, Andrew R Bender, Jeffrey D Bernstein, Marina Boccardi, Martina Bocchetta, Alison Burggren, M Mallar Chakravarty, Marie Chupin, Arne Ekstrom, Robin de Flores, Ricardo Insausti, Prabesh Kanel, Olga Kedo, Kristen M Kennedy, Geoffrey A Kerchner, Karen F LaRocque, Xiuwen Liu, Anne Maass, Nicolai Malykhin, Susanne G Mueller, Noa Ofen, Daniela J Palombo, Mansi B Parekh, John B Pluta, Jens C Pruessner, Naftali Raz, Karen M Rodrigue, Dorothee Schoemaker, Andrea T Shafer, Trevor A Steve, Nanthia Suthana, Lei Wang, Julie L Winterburn, Michael A Yassa, Paul A Yushkevich, Renaud la Joie, and Hippocampal Subfields Group. A harmonized segmentation protocol for hippocampal and parahippocampal subregions: why do we need one and what are the key goals? Hippocampus, 27(1):3‚Äì11, January 2017.">9</a>]</span>).
Mais pour d‚Äôautres r√©gions, comme les aires visuelles (V1, V2, etc.), il est n√©cessaire de r√©aliser des exp√©riences fonctionnelles afin de pouvoir les d√©limiter.
En effet, dans ce dernier cas, les d√©limitations anatomiques ne sont pas toujours disponibles ou bien √©tablies.</p>
<p>Un protocole de segmentation rigoureux est n√©cessaire pour obtenir un bon niveau de <a class="reference external" href="https://en.wikipedia.org/wiki/Inter-rater_reliability">concordance</a> des r√©sultats entre diff√©rents chercheurs (accord inter-juges).
Certains protocoles proposent aussi un processus de certification, ce qui offre une garantie que la personne effectuant la segmentation applique le protocole correctement.</p>
</section>
<section id="segmentation-automatique">
<h3>Segmentation automatique<a class="headerlink" href="#segmentation-automatique" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-input tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># T√©l√©chargement de l&#39;atlas Harvard-Oxford</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span>

<span class="c1"># Enl√®ve les warnings</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="n">atlas</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_atlas_harvard_oxford</span><span class="p">(</span><span class="s1">&#39;cort-maxprob-thr25-2mm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">maps</span>
<span class="n">mni</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_icbm152_2009</span><span class="p">()</span>

<span class="c1"># Visualisation de la figure</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">atlas</span><span class="p">,</span>
    <span class="n">bg_img</span><span class="o">=</span><span class="n">mni</span><span class="o">.</span><span class="n">t1</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Atlas Harvard-Oxford&quot;</span><span class="p">,</span>
    <span class="n">cut_coords</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
    <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;harvard-oxford-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="harvard-oxford-fig" style="width: 800px">
<img alt="_images/c8f8e7b7d7ef20fbc34a59f811617c5c8a27d4c0e2a02aefe61dfd91c6db7229.png" src="_images/c8f8e7b7d7ef20fbc34a59f811617c5c8a27d4c0e2a02aefe61dfd91c6db7229.png" />
<figcaption>
<p><span class="caption-number">Fig. 24 </span><span class="caption-text">Un exemple d‚Äôatlas de r√©gions anatomiques: l‚Äôatlas Harvard-Oxford.
Cette figure est g√©n√©r√©e par du code python √† l‚Äôaide de la librairie <a class="reference external" href="https://nilearn.github.io/">nilearn</a> √† partir d‚Äôun jeu de donn√©es public appel√© fetch_atlas_harvard_oxford (<a class="reference external" href="https://nilearn.github.io/auto_examples/01_plotting/plot_atlas.html">Nilearn, section 9.2.1: Basic Atlas plotting</a>) <span id="id4">[<a class="reference internal" href="references.html#id7" title="Nikos Makris, Jill M. Goldstein, David Kennedy, Steven M. Hodge, Verne S. Caviness, Stephen V. Faraone, Ming T. Tsuang, and Larry J. Seidman. Decreased volume of left and total anterior insular lobule in schizophrenia. Schizophrenia Research, 83(2):155-171, 2006. URL: https://www.sciencedirect.com/science/article/pii/S0920996405004998, doi:https://doi.org/10.1016/j.schres.2005.11.020.">10</a>, <a class="reference internal" href="references.html#id8" title="Jean A. Frazier, Sufen Chiu, Janis L. Breeze, Nikos Makris, Nicholas Lange, David N. Kennedy, Martha R. Herbert, Eileen K. Bent, Vamsi K. Koneru, Megan E. Dieterich, Steven M. Hodge, Scott L. Rauch, P. Ellen Grant, Bruce M. Cohen, Larry J. Seidman, Verne S. Caviness, and Joseph Biederman. Structural brain magnetic resonance imaging of limbic and thalamic volumes in pediatric bipolar disorder. American Journal of Psychiatry, 162(7):1256-1265, 2005. doi:10.1176/appi.ajp.162.7.1256.">11</a>, <a class="reference internal" href="references.html#id9" title="Rahul S. Desikan, Florent S√©gonne, Bruce Fischl, Brian T. Quinn, Bradford C. Dickerson, Deborah Blacker, Randy L. Buckner, Anders M. Dale, R. Paul Maguire, Bradley T. Hyman, Marilyn S. Albert, and Ronald J. Killiany. An automated labeling system for subdividing the human cerebral cortex on mri scans into gyral based regions of interest. NeuroImage, 31(3):968-980, 2006. URL: https://www.sciencedirect.com/science/article/pii/S1053811906000437, doi:https://doi.org/10.1016/j.neuroimage.2006.01.021.">12</a>, <a class="reference internal" href="references.html#id10" title="Jill M. Goldstein, Larry J. Seidman, Nikos Makris, Todd Ahern, Liam M. O‚ÄôBrien, Verne S. Caviness, David N. Kennedy, Stephen V. Faraone, and Ming T. Tsuang. Hypothalamic abnormalities in schizophrenia: sex effects and genetic vulnerability. Biological Psychiatry, 61(8):935-945, 2007. URL: https://www.sciencedirect.com/science/article/pii/S0006322306008195, doi:https://doi.org/10.1016/j.biopsych.2006.06.027.">13</a>]</span> (cliquer sur + pour voir le code).</span><a class="headerlink" href="#harvard-oxford-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Afin d‚Äôautomatiser le travail de segmentation, il est possible d‚Äôutiliser un atlas, c‚Äôest-√†-dire une segmentation d√©j√† effectu√©e par une √©quipe de chercheurs.
Pour ce faire, ceux-ci ont construit une carte des r√©gions d‚Äôint√©r√™t √† l‚Äôint√©rieur d‚Äôun espace de r√©f√©rence, aussi appel√© <a class="reference internal" href="#stereotaxique-tip"><span class="std std-ref">espace st√©r√©otaxique</span></a>.
Il existe une vari√©t√© d‚Äôatlas bas√©s sur diff√©rents crit√®res anatomiques ou fonctionnels, il est donc important de choisir ad√©quatement l‚Äôatlas en fonction des structures √©tudi√©es.
Afin d‚Äôajuster l‚Äôatlas sur les donn√©es d‚Äôun participant, les images structurelles de ce dernier sont d‚Äôabord <a class="reference internal" href="#registration-tip"><span class="std std-ref">recal√©es</span></a> de mani√®re automatis√©e vers l‚Äô<a class="reference internal" href="#stereotaxique-tip"><span class="std std-ref">espace st√©r√©otaxique</span></a> de r√©f√©rence.
Cette transformation permet par la suite d‚Äôadapter l‚Äôatlas √† l‚Äôanatomie de chaque sujet.</p>
<div class="tip admonition" id="registration-tip">
<p class="admonition-title">Le recalage</p>
<p>Afin d‚Äôappliquer un atlas de r√©gions c√©r√©brales sur une IRM individuelle, ou plus g√©n√©ralement mettre en correspondance deux images de cerveaux, il est n√©cessaire de recaler cette IRM sur l‚Äôespace st√©r√©otaxique qui a √©t√© utilis√© pour √©tablir les r√©gions.
Ce processus math√©matique va chercher √† d√©former l‚Äôimage individuelle afin de l‚Äôajuster √† l‚Äôespace st√©r√©otaxique.
Cette transformation peut √™tre affine (incluant notamment translation, rotation et mise √† l‚Äô√©chelle) ou bien non-lin√©aire (d√©placement dans n‚Äôimporte quelle direction de l‚Äôespace).
L‚Äôobjectif du recalage est d‚Äôaugmenter le niveau de similarit√© entre les images, mais il est aussi important que les d√©formations soient continues.
Autrement dit, des endroits adjacents dans les images non-recal√©es doivent toujours √™tre adjacents apr√®s le recalage.
Les images ci-dessous illustrent l‚Äôeffet de diff√©rents types de recalage.
Elles sont tir√©es de la documentation du logiciel <a class="reference external" href="https://www.slicer.org/wiki/Documentation:Nightly:Registration:RegistrationLibrary:RegLib_C42">slicer</a>, sous licence CC-Attributions Share Alike.</p>
<figure class="align-left" id="id17" style="width: 400px">
<img alt="_images/registration_slicer_raw.gif" src="_images/registration_slicer_raw.gif" />
<figcaption>
<p><span class="caption-number">Fig. 25 </span><span class="caption-text">Images brutes: deux scans du m√™me sujet, prises durant deux s√©ances d‚Äôacquisition diff√©rentes.</span><a class="headerlink" href="#id17" title="Link to this image">#</a></p>
<div class="legend">
<figure class="margin-caption align-left" id="id18" style="width: 400px">
<img alt="_images/registration_slicer_affine.gif" src="_images/registration_slicer_affine.gif" />
<figcaption>
<p><span class="caption-number">Fig. 26 </span><span class="caption-text">Images recal√©es par un processus de transformation affine seulement.</span><a class="headerlink" href="#id18" title="Link to this image">#</a></p>
<div class="legend">
<figure class="margin-caption align-left" id="id19" style="width: 400px">
<img alt="_images/registration_slicer_nonlinear.gif" src="_images/registration_slicer_nonlinear.gif" />
<figcaption>
<p><span class="caption-number">Fig. 27 </span><span class="caption-text">Images recal√©es par une transformation affine suivie d‚Äôune transformation non-lin√©aire.</span><a class="headerlink" href="#id19" title="Link to this image">#</a></p>
<div class="legend">
<figure class="margin-caption align-left" id="id20" style="width: 400px">
<img alt="_images/registration_slicer_nonlinear_only.gif" src="_images/registration_slicer_nonlinear_only.gif" />
<figcaption>
<p><span class="caption-number">Fig. 28 </span><span class="caption-text">Visualisation des effets du recalage non-lin√©aire seulement.</span><a class="headerlink" href="#id20" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</figcaption>
</figure>
</div>
</figcaption>
</figure>
</div>
</figcaption>
</figure>
</div>
<div class="cell tag_hide-input tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ce code r√©cup√®re des donn√©es IRM T1</span>
<span class="c1"># et g√©n√®re une image dans trois plans de coupes</span>

<span class="c1"># Enl√®ve les warnings</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="c1"># T√©l√©charge un scan anatomique (template MNI152)</span>
<span class="kn">from</span> <span class="nn">nilearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_icbm152_2009</span>
<span class="n">mni</span> <span class="o">=</span> <span class="n">fetch_icbm152_2009</span><span class="p">()</span>

<span class="c1"># Visualise le volume c√©r√©bral</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="kn">from</span> <span class="nn">nilearn.plotting</span> <span class="kn">import</span> <span class="n">plot_anat</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plot_anat</span><span class="p">(</span>
  <span class="n">mni</span><span class="o">.</span><span class="n">t1</span><span class="p">,</span>
  <span class="n">axes</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span>
  <span class="n">cut_coords</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">17</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">17</span><span class="p">],</span>
  <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Espace stereotaxique MNI152&#39;</span>
<span class="p">)</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;mni-template-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="tip admonition" id="stereotaxique-tip">
<p class="admonition-title">Espace st√©r√©otaxique</p>
<p>Afin de d√©finir une anatomie de r√©f√©rence, les chercheurs utilisent g√©n√©ralement un cerveau ‚Äúmoyen‚Äù.
Pour y parvenir, les cerveaux de plusieurs dizaines d‚Äôindividus sont recal√©s les uns avec les autres, puis moyenn√©s jusqu‚Äô√† obtenir une seule image.
Si le recalage a bien fonctionn√©, comme dans le cas de l‚Äôatlas MNI152 ci-dessous, les d√©tails de la neuroanatomie sont pr√©serv√©s dans la moyenne.</p>
<figure class="align-left" id="id21" style="width: 600px">
<img alt="_images/ced1bfa3dd1af1ac28962cb7e14433567840365770aaff52d679fdd4a3c137cc.png" src="_images/ced1bfa3dd1af1ac28962cb7e14433567840365770aaff52d679fdd4a3c137cc.png" />
<figcaption>
<p><span class="caption-number">Fig. 29 </span><span class="caption-text">Espace st√©r√©otaxique de l‚ÄôInstitut Neurologique de Montr√©al (MNI).
Cette espace de r√©f√©rence a √©t√© obtenu en faisant la moyenne des images c√©r√©brales de 152 sujets apr√®s avoir proc√©d√© √† un recalage non-lin√©aire it√©ratif <span id="id5">[<a class="reference internal" href="references.html#id6" title="Vladimir Fonov, Alan C Evans, Kelly Botteron, C Robert Almli, Robert C McKinstry, D Louis Collins, and Brain Development Cooperative Group. Unbiased average age-appropriate atlases for pediatric studies. Neuroimage, 54(1):313‚Äì327, January 2011.">2</a>]</span>.</span><a class="headerlink" href="#id21" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</section>
<section id="analyses-statistiques">
<h3>Analyses statistiques<a class="headerlink" href="#analyses-statistiques" title="Link to this heading">#</a></h3>
<figure class="align-default" id="ledig2018-stats-fig">
<a class="reference internal image-reference" href="_images/ledig2018_stats.png"><img alt="_images/ledig2018_stats.png" src="_images/ledig2018_stats.png" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 30 </span><span class="caption-text">Cette figure illustre les diff√©rences de volume de l‚Äôhippocampe entre des participants cognitivement sains (HC), des participants pr√©sentant des troubles cognitifs l√©gers stables (sMCI) ou progressifs (pMCI), ainsi que des patients atteints d‚Äôune d√©mence de type Alzheimer (AD), dans la cohorte ADNI.
Plus les sympt√¥mes cliniques sont s√©v√®res, plus la probabilit√© de pr√©senter la maladie d‚ÄôAlzheimer est grande, et plus le stade d‚Äôavancement de la maladie est s√©v√®re.
L‚Äôatrophie de l‚Äôhippocampe est claire chez les patients pr√©sentant les sympt√¥mes les plus s√©v√®res.
Figure tir√©e de <span id="id6">[<a class="reference internal" href="references.html#id13" title="Christian Ledig, Andreas Schuh, Ricardo Guerrero, Rolf A Heckemann, and Daniel Rueckert. Structural brain imaging in alzheimer's disease and mild cognitive impairment: biomarker analysis and shared morphometry database. Sci. Rep., 8(1):1‚Äì16, July 2018.">7</a>]</span>, sous licence CC-BY.</span><a class="headerlink" href="#ledig2018-stats-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Afin de proc√©der aux analyses statistiques, on extrait d‚Äôabord le volume de chaque structure segment√©e (en <span class="math notranslate nohighlight">\(mm^3\)</span>).
On peut ensuite comparer statistiquement le volume moyen entre deux groupes, par exemple, ou encore tester l‚Äôassociation entre le volume et une autre variable, comme l‚Äô√¢ge.
Dans l‚Äôexemple de la <a class="reference internal" href="#ledig2018-stats-fig"><span class="std std-numref">Fig. 30</span></a>, on compare le volume de l‚Äôhippocampe entre diff√©rents groupes cliniques ayant diff√©rents niveaux de risques li√©s √† la maladie d‚ÄôAlzheimer.</p>
</section>
<section id="controle-de-qualite">
<h3>Contr√¥le de qualit√©<a class="headerlink" href="#controle-de-qualite" title="Link to this heading">#</a></h3>
<figure class="align-default" id="artefact-fig">
<a class="reference internal image-reference" href="_images/artefact-fig.png"><img alt="_images/artefact-fig.png" src="_images/artefact-fig.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 31 </span><span class="caption-text">La pr√©sence de m√©tal ou d‚Äô√©l√©ments d√©fectueux dans le scanner peuvent causer des artefacts et des distorsions dans les images qui ne refl√®tent pas la morphologie r√©elle de la t√™te.
Figure d‚Äôorigine inconnue, possiblement sous droits r√©serv√©s.</span><a class="headerlink" href="#artefact-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="qc-fail-fig">
<a class="reference internal image-reference" href="_images/qc-fail-fig.png"><img alt="_images/qc-fail-fig.png" src="_images/qc-fail-fig.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 32 </span><span class="caption-text">Le recalage peut parfois √©chouer de mani√®re spectaculaire.
Ici, la forme rouge indique le pourtour attendu du cerveau et de certains rep√®res anatomiques.
L‚ÄôIRM individuelle recal√©e n‚Äôest pas du tout align√©e avec les rep√®res attendus.
Figure par P. Bellec, sous licence CC-BY.</span><a class="headerlink" href="#qc-fail-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Il est possible d‚Äôobtenir des r√©sultats aberrants en volum√©trie, soit √† cause de la pr√©sence d‚Äôerreurs dans les √©tapes de recalage lin√©aire et/ou non-lin√©aire (<a class="reference internal" href="#qc-fail-fig"><span class="std std-numref">Fig. 32</span></a>), soit √† cause d‚Äôartefacts lors de l‚Äôacquisition des donn√©es (pr√©sence d‚Äôobjets m√©talliques, etc. <a class="reference internal" href="#artefact-fig"><span class="std std-numref">Fig. 31</span></a>). Les images peuvent √©galement √™tre de mauvaise qualit√© si le sujet de recherche bouge pendant l‚Äôacquisition.
Il est important d‚Äôeffectuer un contr·ªìle de qualit√© afin d‚Äô√©liminer les images inutilisables avant de proc√©der aux analyses statistiques.
Conserver ces derni√®res pourrait avoir des impacts importants sur les r√©sultats ainsi que sur les conclusions tir√©es.</p>
</section>
</section>
<section id="vbm">
<h2>VBM<a class="headerlink" href="#vbm" title="Link to this heading">#</a></h2>
<section id="densite-de-matiere-grise">
<h3>Densit√© de mati√®re grise<a class="headerlink" href="#densite-de-matiere-grise" title="Link to this heading">#</a></h3>
<p>La morphom√©trie bas√©e sur les voxels (<em>voxel-based morphometry</em> ou VBM) a pour objectif de mesurer le volume de mati√®re grise situ√© imm√©diatement autour d‚Äôun voxel donn√©.
Cette approche n‚Äôest donc pas limit√©e par le besoin d‚Äôavoir des fronti√®res pr√©√©tablies claires entre diff√©rentes structures c√©r√©brales.
Lorsque l‚Äôon g√©n√®re une mesure de volume pour l‚Äôensemble des voxels du cerveau √† l‚Äôaide de ce genre de technique, on obtient une carte 3D de la densit√© de la mati√®re grise.
Les principaux avantages de cette approche sont ses aspects automatis√©s et syst√©matiques.
La pr√©sence d‚Äôune personne ne devient n√©cessaire que pour v√©rifier que la proc√©dure a fonctionn√© correctement: c‚Äôest l‚Äô√©tape du contr√¥le de qualit√© (ou QC, pour ‚Äúquality control‚Äù).
On va aussi tester la morphologie du cerveau √† travers l‚Äôensemble de la mati√®re grise.
D‚Äôun autre c√¥t√©, cette technique comporte aussi un inconv√©nient important.
En effet, le grand nombre de mesures g√©n√©r√©es pose un probl√®me de <em>comparaisons multiples</em> lorsque vient le temps de faire les analyses statistiques (voir le <a class="reference internal" href="cartes_statistiques.html#cartes-statistiques-chapitre"><span class="std std-ref">Chapitre 9: Cartes statistiques</span></a>).</p>
</section>
<section id="segmentation">
<h3>Segmentation<a class="headerlink" href="#segmentation" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-input tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importe les librairies n√©cessaires</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="c1"># T√©l√©charge un scan anatomique (template MNI152)</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="n">mni</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_icbm152_2009</span><span class="p">()</span>

<span class="c1"># Initialise la figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>

<span class="kn">from</span> <span class="nn">nilearn.plotting</span> <span class="kn">import</span> <span class="n">plot_stat_map</span>
<span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <span class="n">math_img</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiMasker</span>

<span class="n">thresh</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">]</span>

<span class="c1"># Full brain</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mask_brain</span> <span class="o">=</span> <span class="n">math_img</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;img&gt;</span><span class="si">{</span><span class="n">thresh</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">mni</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
<span class="n">val_brain</span> <span class="o">=</span> <span class="n">NiftiMasker</span><span class="p">(</span><span class="n">mask_img</span><span class="o">=</span><span class="n">mask_brain</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">mni</span><span class="o">.</span><span class="n">t1</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">val_brain</span><span class="p">,</span> <span class="n">norm_hist</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plot_stat_map</span><span class="p">(</span><span class="n">mni</span><span class="o">.</span><span class="n">mask</span><span class="p">,</span>
              <span class="n">bg_img</span><span class="o">=</span><span class="n">mni</span><span class="o">.</span><span class="n">t1</span><span class="p">,</span>
              <span class="n">cut_coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
              <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span>
              <span class="n">black_bg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Cerveau&#39;</span>
              <span class="p">)</span>

<span class="c1"># Gray matter</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mask_gm</span> <span class="o">=</span> <span class="n">math_img</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;img&gt;</span><span class="si">{</span><span class="n">thresh</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">mni</span><span class="o">.</span><span class="n">gm</span><span class="p">)</span>
<span class="n">val_gm</span> <span class="o">=</span> <span class="n">NiftiMasker</span><span class="p">(</span><span class="n">mask_img</span><span class="o">=</span><span class="n">mask_gm</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">mni</span><span class="o">.</span><span class="n">t1</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">val_gm</span><span class="p">,</span> <span class="n">norm_hist</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plot_stat_map</span><span class="p">(</span><span class="n">mni</span><span class="o">.</span><span class="n">gm</span><span class="p">,</span>
              <span class="n">bg_img</span><span class="o">=</span><span class="n">mni</span><span class="o">.</span><span class="n">t1</span><span class="p">,</span>
              <span class="n">cut_coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
              <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span>
              <span class="n">black_bg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Mati√®re grise&#39;</span>
              <span class="p">)</span>

<span class="c1"># White matter</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mask_wm</span> <span class="o">=</span> <span class="n">math_img</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;img&gt;</span><span class="si">{</span><span class="n">thresh</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">mni</span><span class="o">.</span><span class="n">wm</span><span class="p">)</span>
<span class="n">val_wm</span> <span class="o">=</span> <span class="n">NiftiMasker</span><span class="p">(</span><span class="n">mask_img</span><span class="o">=</span><span class="n">mask_wm</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">mni</span><span class="o">.</span><span class="n">t1</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">val_wm</span><span class="p">,</span> <span class="n">norm_hist</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plot_stat_map</span><span class="p">(</span><span class="n">mni</span><span class="o">.</span><span class="n">wm</span><span class="p">,</span>
              <span class="n">bg_img</span><span class="o">=</span><span class="n">mni</span><span class="o">.</span><span class="n">t1</span><span class="p">,</span>
              <span class="n">cut_coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
              <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span>
              <span class="n">black_bg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Mati√®re blanche&#39;</span>
              <span class="p">)</span>

<span class="c1"># CSF</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mask_csf</span> <span class="o">=</span> <span class="n">math_img</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;img&gt;</span><span class="si">{</span><span class="n">thresh</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">mni</span><span class="o">.</span><span class="n">csf</span><span class="p">)</span>
<span class="n">val_csf</span> <span class="o">=</span> <span class="n">NiftiMasker</span><span class="p">(</span><span class="n">mask_img</span><span class="o">=</span><span class="n">mask_csf</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">mni</span><span class="o">.</span><span class="n">t1</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">val_csf</span><span class="p">,</span> <span class="n">axlabel</span><span class="o">=</span><span class="s2">&quot;intensit√© de l&#39;image&quot;</span><span class="p">,</span> <span class="n">norm_hist</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plot_stat_map</span><span class="p">(</span><span class="n">mni</span><span class="o">.</span><span class="n">csf</span><span class="p">,</span>
              <span class="n">bg_img</span><span class="o">=</span><span class="n">mni</span><span class="o">.</span><span class="n">t1</span><span class="p">,</span>
              <span class="n">cut_coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
              <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span>
              <span class="n">black_bg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Liquide c√©phalo-rachidien&#39;</span>
              <span class="p">)</span>

<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;mni-segmentation-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="mni-segmentation-fig" style="width: 600px">
<img alt="_images/38c539d9b5ad5bea4bfb38fbb0424d8d890988b148d47c9c34a5557166fe7848.png" src="_images/38c539d9b5ad5bea4bfb38fbb0424d8d890988b148d47c9c34a5557166fe7848.png" />
<figcaption>
<p><span class="caption-number">Fig. 33 </span><span class="caption-text">Segmentation probabiliste des principaux types de tissus et distribution des valeurs pond√©r√©es en T1 dans les voxels ‚Äúpurs‚Äù (probabilit√© sup√©rieure √† 80% pour un type de tissu donn√©).
L‚Äôimage pond√©r√©e en T1 ainsi que les segmentations correspondent √† l‚Äôespace st√©r√©otaxique MNI152 <span id="id7">[<a class="reference internal" href="references.html#id6" title="Vladimir Fonov, Alan C Evans, Kelly Botteron, C Robert Almli, Robert C McKinstry, D Louis Collins, and Brain Development Cooperative Group. Unbiased average age-appropriate atlases for pediatric studies. Neuroimage, 54(1):313‚Äì327, January 2011.">2</a>]</span>.</span><a class="headerlink" href="#mni-segmentation-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Une √©tape importante de la VBM est la segmentation.
Cette analyse vise √† cat√©goriser les types de tissus du cerveau en diff√©rentes classes contenant notamment la mati√®re grise, la mati√®re blanche et le liquide c√©phalo-rachidien.
Un masque du cerveau est g√©n√©ralement extrait afin d‚Äôexclure les m√©ninges ainsi que le cr√¢ne.
On va g√©n√©ralement y inclure d‚Äôautres types de tissus √©galement, comme la graisse.
Un algorithme de segmentation va ensuite examiner la distribution des niveaux de gris dans l‚Äôimage (par exemple, dans une image pond√©r√©e en T1) et estimer pour chaque voxel la proportion du voxel qui contient un type de tissu donn√©.
Cette proportion est souvent appel√© l‚Äô<a class="reference internal" href="#volume-partiel-tip"><span class="std std-ref">effet de volume partiel</span></a>.
Un voxel peut par exemple √™tre assign√© √† 80% de mati√®re grise et 20% de liquide c√©phalo-rachidien.
Le niveau de gris r√©sultant pourrait alors donner une indication trompeuse sur son contenu r√©el.</p>
<div class="tip admonition" id="volume-partiel-tip">
<p class="admonition-title">Effet de volume partiel</p>
<p>Il est possible que la segmentation automatique nous retourne pour certains tissus non-d√©sir√©s des valeurs similaires √† celle de la mati√®re grise sur l‚Äôimage r√©sultant de cette √©tape.
En effet, il est possible que des voxels se trouvant directement sur la jonction entre une zone blanche et une zone noire (par exemple, sur une paroi de mati√®re blanche qui borderait un ventricule) aient comme valeur r√©sultante une valeur s‚Äôapparentant plut√¥t au gris associ√© √† la mati√®re grise (valeur moyenne entre blanc et noir).
On appelle ce genre d‚Äôeffet de m√©lange de noir et de blanc un volume partiel (une partie du volume du voxel est blanche alors que l‚Äôautre partie est noire).</p>
</div>
</section>
<section id="lissage">
<h3>Lissage<a class="headerlink" href="#lissage" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-input tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importe les librairies n√©cessaires</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="c1"># T√©l√©charge un scan anatomique (template MNI152)</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="n">mni</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_icbm152_2009</span><span class="p">()</span>

<span class="c1"># Initialise la figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>

<span class="kn">from</span> <span class="nn">nilearn.plotting</span> <span class="kn">import</span> <span class="n">plot_anat</span>
<span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <span class="n">math_img</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiMasker</span>
<span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <span class="n">smooth_img</span>

<span class="n">list_fwhm</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">n_fwhm</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_fwhm</span><span class="p">)</span>
<span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">]</span>

<span class="k">for</span> <span class="n">num</span><span class="p">,</span> <span class="n">fwhm</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">list_fwhm</span><span class="p">):</span>
    <span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="n">n_fwhm</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">vol</span> <span class="o">=</span> <span class="n">smooth_img</span><span class="p">(</span><span class="n">mni</span><span class="o">.</span><span class="n">gm</span><span class="p">,</span> <span class="n">fwhm</span><span class="p">)</span>
    <span class="n">plot_anat</span><span class="p">(</span><span class="n">vol</span><span class="p">,</span>
              <span class="n">cut_coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
              <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span>
              <span class="n">black_bg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;FWHM=</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
              <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;smoothing-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="smoothing-fig" style="width: 600px">
<img alt="_images/140aa848a021d1660cec7577a1bdce88680bea2f9c7c837ca0a344f7afdc28b1.png" src="_images/140aa848a021d1660cec7577a1bdce88680bea2f9c7c837ca0a344f7afdc28b1.png" />
<figcaption>
<p><span class="caption-number">Fig. 34 </span><span class="caption-text">Illustration de l‚Äôimpact du lissage sur une carte de densit√© de mati√®re grise en VBM.
√Ä mesure que le param√®tre <code class="docutils literal notranslate"><span class="pre">FWHM</span></code> augmente, la mesure de la densit√© repr√©sente une r√©gion entourant le voxel de plus en plus grande.
Cette figure est g√©n√©r√©e par du code python √† l‚Äôaide de la librairie <a class="reference external" href="https://nilearn.github.io/">nilearn</a> √† partir d‚Äôun jeu de donn√©es public appel√© template MNI152 2009 <span id="id8">[<a class="reference internal" href="references.html#id6" title="Vladimir Fonov, Alan C Evans, Kelly Botteron, C Robert Almli, Robert C McKinstry, D Louis Collins, and Brain Development Cooperative Group. Unbiased average age-appropriate atlases for pediatric studies. Neuroimage, 54(1):313‚Äì327, January 2011.">2</a>]</span> (cliquer sur + pour voir le code).</span><a class="headerlink" href="#smoothing-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>L‚Äô√©tape suivante correspond au <em>lissage spatial</em>.
Celui-ci consiste √† ajouter un filtre sur l‚Äôimage qui va la rendre plus floue.
En pratique, le lissage remplace la valeur associ√©e √† chaque voxel par une moyenne pond√©r√©e de ses voisins.
Comme c‚Äôest une moyenne pond√©r√©e, la valeur originale du voxel est celle qui aura la plus grande pond√©ration, mais les valeurs des voxels situ√©s directement autour vont aussi l‚Äôaffecter grandement.
La valeur des poids suit le profil d‚Äôune distribution Gaussienne 3D (plus un voxel voisin est loin du voxel d‚Äôint√©r√™t, moins il en affectera la valeur).
Il est n√©cessaire de proc√©der √† cette √©tape afin d‚Äôobtenir des valeurs de densit√© de mati√®re grise pour des zones qui d√©passe le voxel unique, mais qui repr√©sentent plut√¥t le volume d‚Äôune petite r√©gion, centr√©e sur le voxel.
La taille de la r√©gion est contr√¥l√©e par un param√®tre de <em>largeur √† mi-hauteur</em>, ou <code class="docutils literal notranslate"><span class="pre">FWHM</span></code> (<em>full width at half maximum</em>), qui se mesure en millim√®tres.
Plus la valeur de FWHM est grande, plus grand sera le rayon du voisinage contenant les voxels qui auront un impact sur la valeur liss√©e du voxel (voir la <a class="reference internal" href="#smoothing-fig"><span class="std std-numref">Fig. 34</span></a>).</p>
</section>
<section id="id9">
<h3>Analyses statistiques<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-input tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiMasker</span>
<span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <span class="n">get_data</span>

<span class="n">n_subjects</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># more subjects requires more memory</span>

<span class="c1"># Charge les donn√©es</span>
<span class="n">oasis_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_oasis_vbm</span><span class="p">(</span><span class="n">n_subjects</span><span class="o">=</span><span class="n">n_subjects</span><span class="p">)</span>
<span class="n">gray_matter_map_filenames</span> <span class="o">=</span> <span class="n">oasis_dataset</span><span class="o">.</span><span class="n">gray_matter_maps</span>
<span class="n">age</span> <span class="o">=</span> <span class="n">oasis_dataset</span><span class="o">.</span><span class="n">ext_vars</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

<span class="c1"># Pr√©traitement (mask)</span>
<span class="n">nifti_masker</span> <span class="o">=</span> <span class="n">NiftiMasker</span><span class="p">(</span>
    <span class="n">standardize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">smoothing_fwhm</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">memory</span><span class="o">=</span><span class="s1">&#39;nilearn_cache&#39;</span><span class="p">)</span>  <span class="c1"># cache options</span>

<span class="c1"># Normalise les donn√©es</span>
<span class="n">gm_maps_masked</span> <span class="o">=</span> <span class="n">nifti_masker</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">gray_matter_map_filenames</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">VarianceThreshold</span>
<span class="n">variance_threshold</span> <span class="o">=</span> <span class="n">VarianceThreshold</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mf">.01</span><span class="p">)</span>

<span class="n">gm_maps_thresholded</span> <span class="o">=</span> <span class="n">variance_threshold</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">gm_maps_masked</span><span class="p">)</span>
<span class="n">gm_maps_masked</span> <span class="o">=</span> <span class="n">variance_threshold</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">gm_maps_thresholded</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">variance_threshold</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">gm_maps_masked</span><span class="p">)</span>

<span class="c1"># Mod√®le de r√©gression massivement univari√©</span>
<span class="kn">from</span> <span class="nn">nilearn.mass_univariate</span> <span class="kn">import</span> <span class="n">permuted_ols</span>
<span class="n">neg_log_pvals</span><span class="p">,</span> <span class="n">t_scores_original_data</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">permuted_ols</span><span class="p">(</span>
    <span class="n">age</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span>  <span class="c1"># + intercept as a covariate by default</span>
    <span class="n">n_perm</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>  <span class="c1"># 1,000 in the interest of time; 10000 would be better</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="c1"># display progress bar</span>
    <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># can be changed to use more CPUs</span>
<span class="n">signed_neg_log_pvals</span> <span class="o">=</span> <span class="n">neg_log_pvals</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">t_scores_original_data</span><span class="p">)</span>
<span class="n">signed_neg_log_pvals_unmasked</span> <span class="o">=</span> <span class="n">nifti_masker</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span>
    <span class="n">variance_threshold</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">signed_neg_log_pvals</span><span class="p">))</span>

<span class="c1"># Visualise les r√©sultats</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># 10% corrected</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">bg_filename</span> <span class="o">=</span> <span class="n">gray_matter_map_filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cut_coords</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">display</span> <span class="o">=</span> <span class="n">plot_stat_map</span><span class="p">(</span><span class="n">signed_neg_log_pvals_unmasked</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">bg_filename</span><span class="p">,</span>
                        <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu_r</span><span class="p">,</span>
                        <span class="n">cut_coords</span><span class="o">=</span><span class="n">cut_coords</span><span class="p">,</span>
                        <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
<span class="n">title</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Negative $</span><span class="se">\\</span><span class="s1">log_</span><span class="si">{10}</span><span class="s1">$ p-values&#39;</span>
         <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">(Non-parametric + max-type correction)&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;vbm-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="vbm-fig" style="width: 600px">
<img alt="_images/1f2f99b8e602ea80aed76181594d2192d64ea81bd026476537cf4ddf5b3c7850.png" src="_images/1f2f99b8e602ea80aed76181594d2192d64ea81bd026476537cf4ddf5b3c7850.png" />
<figcaption>
<p><span class="caption-number">Fig. 35 </span><span class="caption-text">R√©gression lin√©aire en VBM.
On teste ici l‚Äôeffet de l‚Äô√¢ge sur un groupe (N=50) de participants de la base de donn√©es OASIS.
La significativit√© <span class="math notranslate nohighlight">\(-\log_{10}(p)\)</span> de l‚Äôeffet de l‚Äô√¢ge est superpos√©e √† une image de densit√© de mati√®re grise.
Cette figure est adapt√©e d‚Äôun tutoriel <a class="reference external" href="https://nilearn.github.io/auto_examples/02_decoding/plot_oasis_vbm.html#sphx-glr-auto-examples-02-decoding-plot-oasis-vbm-py">Nilearn</a>.</span><a class="headerlink" href="#vbm-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Afin de pouvoir comparer les valeurs de densit√© de mati√®re grise entre les sujets, on utilise la m√™me proc√©dure de <a class="reference internal" href="#registration-tip"><span class="std std-ref">recalage</span></a> non-lin√©aire que pour la volum√©trie automatique.
Contrairement √† la volum√©trie manuelle, o√π chaque volume √† l‚Äô√©tude est d√©limit√© de fa√ßon √† repr√©senter la m√™me structure d‚Äôint√©r√™t, le recalage utilis√© en VBM n‚Äôest pas li√© √† une structure particuli√®re.
Une fois les cartes de densit√© recal√©es dans l‚Äôespace st√©r√©otaxique de r√©f√©rence, on peut proc√©der √† des tests statistiques √† chaque voxel.
Dans l‚Äôexemple ci-dessus, on teste l‚Äôeffet de l‚Äô√¢ge sur la mati√®re grise.
C‚Äôest g√©n√©ralement ce genre d‚Äôimage qui sera par la suite ins√©r√© √† l‚Äôint√©rieur des publications scientifiques.</p>
</section>
<section id="id10">
<h3>Contr√¥le de qualit√©<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<figure class="align-default" id="segmentation-error-volume-fig">
<a class="reference internal image-reference" href="_images/segmentation-error-volume-fig.png"><img alt="_images/segmentation-error-volume-fig.png" src="_images/segmentation-error-volume-fig.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 36 </span><span class="caption-text">Image de gauche: IRM individuelle pond√©r√©e en T1.
Image de droite: classification mati√®re grise et mati√®re blanche g√©n√©r√©e par le logiciel <a class="reference external" href="http://stnava.github.io/ANTs/">ANTS</a>.
Notez comment la mati√®re blanche proche du gyrus est classifi√© de mani√®re erronn√©e comme mati√®re grise.
Image sous licence CC Attribution, tir√©e de Klein et al., 2017 <span id="id11">[<a class="reference internal" href="references.html#id15" title="Arno Klein, Satrajit S Ghosh, Forrest S Bao, Joachim Giard, Yrj√∂ H√§me, Eliezer Stavsky, Noah Lee, Brian Rossa, Martin Reuter, Elias Chaibub Neto, and Anisha Keshavan. Mindboggling morphometry of human brains. PLoS Comput. Biol., 13(2):e1005350, February 2017.">14</a>]</span>.</span><a class="headerlink" href="#segmentation-error-volume-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Comme pour toute op√©ration automatis√©e, il existe toujours une possibilit√© d‚Äôerreur en VBM.
Il est donc n√©cessaire de pr√©voir une √©tape de contr√¥le de qualit√© afin de s‚Äôassurer qu‚Äôil n‚Äôy a pas eu d‚Äôaberrations qui se sont introduites dans les √©tapes de traitement.
On a d√©j√† discut√© des artefacts dans les donn√©es ainsi que des probl√®mes de recalage.
La VBM est aussi tr√®s sensible aux erreurs dans l‚Äô√©tape de la segmentation.
Il est donc possible de perdre certaines structures pour lesquelles le contraste entre la mati√®re blanche et la mati√®re grise n‚Äôest pas assez important pour que l‚Äôalgorithme r√©ussisse √† les classifier efficacement.
Pour ce genre de structure, il est important d‚Äôajouter des <em>a priori</em> (des r√®gles ou des conditions suppl√©mentaires) afin de ne pas les perdre.
Il est aussi envisageable de corriger cette partie de la segmentation de fa√ßon manuelle ou d‚Äôexclure les donn√©es de certains participants.</p>
</section>
</section>
<section id="analyses-de-surface">
<h2>Analyses de surface<a class="headerlink" href="#analyses-de-surface" title="Link to this heading">#</a></h2>
<section id="extraction-de-surface">
<h3>Extraction de surface<a class="headerlink" href="#extraction-de-surface" title="Link to this heading">#</a></h3>
<figure class="align-default" id="surface-fig">
<a class="reference internal image-reference" href="_images/surface-fig.png"><img alt="_images/surface-fig.png" src="_images/surface-fig.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 37 </span><span class="caption-text">Illustration de la position de la surface piale et de la surface int√©rieure.
En haut: coupe d‚ÄôIRM pond√©r√©e en T1 avec les surfaces estim√©es de mani√®re automatique.
En bas: illustration sch√©matique des surfaces.
Figure adapt√©e par P. Bellec √† partir de figures de l‚Äôarticle de Klein et al., 2017 <span id="id12">[<a class="reference internal" href="references.html#id15" title="Arno Klein, Satrajit S Ghosh, Forrest S Bao, Joachim Giard, Yrj√∂ H√§me, Eliezer Stavsky, Noah Lee, Brian Rossa, Martin Reuter, Elias Chaibub Neto, and Anisha Keshavan. Mindboggling morphometry of human brains. PLoS Comput. Biol., 13(2):e1005350, February 2017.">14</a>]</span> sous licence CC-BY.</span><a class="headerlink" href="#surface-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Les analyses de surface corticale diff√®rent des pr√©c√©dentes techniques de morphom√©trie en ce qu‚Äôelles exploitent le ruban que la mati√®re grise forme en s‚Äô√©tendant √† la surface de la mati√®re blanche.
En plus des √©tapes de segmentation et de recalage que l‚Äôon a vu pr√©c√©demment, on va utiliser ici un algorithme qui va d√©tecter la <em>surface piale</em>, √† la fronti√®re entre la mati√®re grise et le liquide c√©phalo-rachidien, et la <em>surface int√©rieure</em> (aussi appel√©e <em>surface blanche</em>), √† la fronti√®re entre la mati√®re blanche et la mati√®re grise.
Il faudra √©galement, comme pour la VBM, extraire un masque du cerveau en √©liminant les structures n‚Äôappartenant pas au cortex (bo√Æte cr√¢nienne, tissus adipeux, m√©ninges, liquide c√©phalo-rachidien, etc.).
Ce genre d‚Äôanalyse permet de produire des surfaces donnant lieu √† de <a class="reference external" href="https://gallantlab.org/huth2016/">magnifiques visualisations interactives</a>.</p>
<div class="tip admonition">
<p class="admonition-title">Croissance de ballon</p>
<p>Pour estimer la position des surfaces piale et int√©rieure, on place un ballon virtuel au centre de chacun des h√©misph√®res du cerveau.
On mod√©lise ensuite des contraintes physiques √† la fronti√®re entre la mati√®re blanche et la mati√®re grise (surface interne).
On proc√®de ensuite √† ‚Äúgonfler‚Äù ce ballon jusqu‚Äô√† ce qu‚Äôil √©pouse le mieux possible la fronti√®re de la surface interne (jusqu‚Äô√† ce que le ballon soit gonfl√© et occupe tout l‚Äôespace dans la cavit√© et qu‚Äôil √©pouse l‚Äôensemble des courbes de la paroi).
Il est aussi possible de faire la proc√©dure inverse.
On pourrait en effet g√©n√©rer un ballon virtuel autour de chacun des h√©misph√®res et les ‚Äúd√©gonfler‚Äù jusqu‚Äô√† ce qu‚Äôils √©pousent les contours des fronti√®res d√©limit√©es par les contraintes physiques.
Lorsque l‚Äôune des fronti√®res (surface interne ou surface piale) est d√©limit√©e, il est possible de continuer la proc√©dure de gonflement/d√©gonflement afin d‚Äôobtenir la seconde surface.</p>
</div>
<div class="caution attention admonition" id="controle-qualite-attention">
<p class="admonition-title">Attention</p>
<p>Les techniques d‚Äôextraction de surface telles que celles propos√©es par le logiciel FreeSurfer sont co√ªteuses en terme de ressources de calcul.
G√©n√©rer une surface √† partir d‚Äôune IRM structurelle peut prendre jusqu‚Äô√† 10 heures sur un ordinateur standard.</p>
</div>
</section>
<section id="epaisseur-surface-et-volume">
<h3>√âpaisseur, surface et volume<a class="headerlink" href="#epaisseur-surface-et-volume" title="Link to this heading">#</a></h3>
<figure class="align-default" id="thickness-fig">
<a class="reference internal image-reference" href="_images/thickness-fig.png"><img alt="_images/thickness-fig.png" src="_images/thickness-fig.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 38 </span><span class="caption-text">Illustration des mesures de surface, d‚Äô√©paisseur et de volume du cortex.
Figure adapt√©e par P. Bellec √† partir de figures de l‚Äôarticle de Winkler et al., 2018 <span id="id13">[<a class="reference internal" href="references.html#id16" title="Anderson M Winkler, Douglas N Greve, Knut J Bjuland, Thomas E Nichols, Mert R Sabuncu, Asta K H√•berg, Jon Skranes, and Lars M Rimol. Joint analysis of cortical area and thickness as a replacement for the analysis of the volume of the cerebral cortex. Cereb. Cortex, 28(2):738‚Äì749, February 2018.">15</a>]</span> sous licence CC-BY.</span><a class="headerlink" href="#thickness-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>La reconstruction de la g√©om√©trie de la surface va permettre de d√©composer le volume de la mati√®re grise en une √©paisseur locale, et une surface locale.
Ces deux propri√©t√©s peuvent maintenant √™tre √©tudi√©es s√©par√©ment, contrairement √† ce qu‚Äôil est possible de faire avec une analyse VBM, et il a √©t√© d√©montr√© qu‚Äôelles sont li√©es de mani√®re ind√©pendante √† diff√©rentes conditions neurologiques et psychiatriques.
Pour ce faire, au lieu d‚Äôanalyser le contenu d‚Äôunit√©s de volume (voxels), comme c‚Äô√©tait le cas pour la VBM, on utilisera ici l‚Äôanalyse du contenu d‚Äôunit√©s de surface: les <strong>vertex</strong>.</p>
<div class="caution attention admonition" id="surface-warning">
<p class="admonition-title">Attention</p>
<p>Qui dit surface corticale, sous-entend aussi que les structures sous-corticales sont laiss√©es de c√¥t√©.
Pour les structures enfouies dans la bo√Æte cr√¢nienne, telles que les thalami et les ganglions de la base, il faut combiner l‚Äôanalyse de surface avec une volum√©trie automatique (pour les structures sous-corticales).</p>
</div>
</section>
<section id="id14">
<h3>Analyses statistiques<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-input tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="n">fsaverage</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_surf_fsaverage</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">nilearn.plotting</span> <span class="kn">import</span> <span class="n">plot_surf_stat_map</span>
<span class="kn">from</span> <span class="nn">nilearn.surface</span> <span class="kn">import</span> <span class="n">vol_to_surf</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">texture</span> <span class="o">=</span> <span class="n">vol_to_surf</span><span class="p">(</span><span class="n">signed_neg_log_pvals_unmasked</span><span class="p">,</span> <span class="n">fsaverage</span><span class="o">.</span><span class="n">pial_right</span><span class="p">)</span>

<span class="n">plot_surf_stat_map</span><span class="p">(</span><span class="n">fsaverage</span><span class="o">.</span><span class="n">white_right</span><span class="p">,</span> <span class="n">texture</span><span class="p">,</span> <span class="n">hemi</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="s1">&#39;lateral&#39;</span><span class="p">,</span>
                            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Surface blanche h√©misph√®re droit&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">bg_map</span><span class="o">=</span><span class="n">fsaverage</span><span class="o">.</span><span class="n">sulc_right</span><span class="p">,</span>
                            <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;surf-stat-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="surf-stat-fig" style="width: 700px">
<img alt="_images/2cccd15e787f56cde8f84b93e1e825d9c7b1fa745d064c8d87859b61f0eb38ae.png" src="_images/2cccd15e787f56cde8f84b93e1e825d9c7b1fa745d064c8d87859b61f0eb38ae.png" />
<figcaption>
<p><span class="caption-number">Fig. 39 </span><span class="caption-text">Projection de la carte statistique pr√©sent√©e √† la <a class="reference internal" href="#vbm-fig"><span class="std std-numref">Fig. 35</span></a> sur l‚Äôatlas de surface corticale <code class="docutils literal notranslate"><span class="pre">fsaverage</span></code>. Cette figure est adapt√©e d‚Äôun tutoriel <a class="reference external" href="https://nilearn.github.io/modules/generated/nilearn.plotting.plot_surf_stat_map.html">Nilearn</a>.</span><a class="headerlink" href="#surf-stat-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Les analyses statistiques fonctionnent exactement de la m√™me fa√ßon pour les analyses de surface que pour la VBM.
Mais √† la place de faire un test statistique au niveau de chacun des voxels (comme en VBM), on fait maintenant un test pour chacun des vertex (surface).</p>
</section>
<section id="id15">
<h3>Contr√¥le de qualit√©<a class="headerlink" href="#id15" title="Link to this heading">#</a></h3>
<figure class="align-default" id="segmentation-error-surface-fig">
<a class="reference internal image-reference" href="_images/segmentation-error-surface-fig.png"><img alt="_images/segmentation-error-surface-fig.png" src="_images/segmentation-error-surface-fig.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 40 </span><span class="caption-text">Image de gauche: IRM individuelle pond√©r√©e en T1.
Image de droite: Extraction de surface automatis√©e.
Notez que la surface piale ne suit pas correctement l‚Äôinterface entre la mati√®re grise et le liquide c√©phalo-rachidien √† l‚Äôendroit indiqu√©.
Image sous licence CC Attribution, tir√©e de Klein et al., 2017 <span id="id16">[<a class="reference internal" href="references.html#id15" title="Arno Klein, Satrajit S Ghosh, Forrest S Bao, Joachim Giard, Yrj√∂ H√§me, Eliezer Stavsky, Noah Lee, Brian Rossa, Martin Reuter, Elias Chaibub Neto, and Anisha Keshavan. Mindboggling morphometry of human brains. PLoS Comput. Biol., 13(2):e1005350, February 2017.">14</a>]</span>.</span><a class="headerlink" href="#segmentation-error-surface-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>La technique d‚Äôextraction de surface n‚Äôest pas robuste aux effets des volumes partiels.
On pourrait en effet avoir une surface qui ne se rend pas jusqu‚Äôau fond d‚Äôun sulcus, ou lorsque les gyri sont tr√®s rapproch√©s, qui n‚Äôentre m√™me pas √† l‚Äôint√©rieur du sulcus.
Le r√©sultat de ces deux types d‚Äôerreur, qui sont possibles tant au niveau de la surface piale que de la surface interne, sera une forte surestimation localis√©e de l‚Äô√©paisseur corticale.
C‚Äôest pourquoi il est souhaitable de proc√©der √† des contr√¥les de qualit√© fr√©quemment sur l‚Äôensemble des images et de corriger les erreurs de segmentation √† la main, ou bien d‚Äôexclure les donn√©es de certains participants.</p>
</section>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h2>
<p>Ce chapitre vous a introduit aux diff√©rentes familles de techniques de morphologie computationnelle qu‚Äôil est possible d‚Äôutiliser avec des donn√©es acquises en imagerie par r√©sonance magn√©tique anatomique.
On y a discut√© de plusieurs techniques cl√©s d‚Äôanalyse d‚Äôimage et l‚Äôon a commenc√© √† introduire certains mod√®les statistiques.</p>
</section>
<section id="exercices">
<h2>Exercices<a class="headerlink" href="#exercices" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">Exercice 1</p>
<p>Pour chacun des √©nonc√©s suivants, sp√©cifiez si l‚Äôaffirmation est vraie ou fausse.</p>
<ol class="arabic simple">
<li><p>Les mouvements d‚Äôun participant de recherche peuvent cr√©er du bruit dans une carte VBM.</p></li>
<li><p>La pr√©sence de m√©tal peut cr√©er du bruit et des d√©formations dans une carte VBM.</p></li>
<li><p>Un trou dans une carte c√©r√©brale VBM signifie n√©cessairement qu‚Äôil y a un trou dans le cerveau du participant.</p></li>
</ol>
</div>
<div class="note admonition">
<p class="admonition-title">Exercice 2</p>
<p>Pour chacun des √©nonc√©s suivants, sp√©cifiez si l‚Äôaffirmation est vraie ou fausse.</p>
<ol class="arabic simple">
<li><p>Les donn√©es IRM doivent √™tre recal√©es dans un espace st√©r√©otaxique pour √©tudier la morphologie du cerveau √† l‚Äô√©chelle d‚Äôune population en VBM.</p></li>
<li><p>Les donn√©es IRM doivent √™tre recal√©es dans un espace st√©r√©otaxique pour effectuer une segmentation manuelle de l‚Äôhippocampe.</p></li>
<li><p>La VBM repose sur la segmentation automatique de la mati√®re grise dans une IRM.</p></li>
</ol>
</div>
<div class="note admonition">
<p class="admonition-title">Exercice 3</p>
<p>Choisissez la bonne r√©ponse. Des donn√©es d‚ÄôIRM pond√©r√©es en T1 pour un participant sont‚Ä¶</p>
<ol class="arabic simple">
<li><p>Une image 3D d‚Äôun cerveau.</p></li>
<li><p>Des dizaines d‚Äôimages 2D sagittales d‚Äôun cerveau.</p></li>
<li><p>Des dizaines d‚Äôimages 2D axiales, coronales et sagittales d‚Äôun cerveau.</p></li>
<li><p>Toutes ces r√©ponses.</p></li>
</ol>
</div>
<div class="note admonition">
<p class="admonition-title">Exercice 4</p>
<p>En v√©rifiant ses donn√©es structurelles, une chercheuse r√©alise qu‚Äôun de ses participants de recherche a un volume c√©r√©bral de deux fois sup√©rieur √† la normale!
Pourtant, le cr√¢ne de ce participant semblait normal.
Proposez une explication.</p>
</div>
<div class="note admonition">
<p class="admonition-title">Exercice 5</p>
<p>On souhaite faire une comparaison entre la quantit√© de mati√®re grise pr√©sente au niveau du cortex moteur primaire et celle contenue dans le cortex sensoriel primaire, en moyenne, sur une population. Ces deux cortex sont situ√©s tr√®s pr√®s l‚Äôun de l‚Äôautre, de part et d‚Äôautre du sillon central. On consid√®re pour cela deux m√©thodes alternatives: une analyse VBM ou bien une analyse de l‚Äô√©paisseur corticale (analyse de surface).
Quelle technique choisiriez-vous et pourquoi?</p>
</div>
<div class="note admonition">
<p class="admonition-title">Exercice 6</p>
<p>On souhaite comparer le volume moyen de l‚Äôhippocampe droit entre des participants pr√©sentant une d√©mence de type Alzheimer et des participants en sant√©. On fait l‚Äôhypoth√®se que c‚Äôest la partie ant√©rieure de l‚Äôhippocampe qui pr√©sente une diff√©rence.
On consid√®re pour cela deux m√©thodes alternatives: la volum√©trie manuelle et l‚Äôanalyse VBM.
Pour chacune de ces techniques, citez une force et une faiblesse en lien avec les objectifs de l‚Äô√©tude.</p>
</div>
<div class="note admonition">
<p class="admonition-title">Exercice 7</p>
<p>Pour r√©pondre aux questions de cet exercice, lisez d‚Äôabord l‚Äôarticle <em>Development of cortical thickness and surface area in autism spectrum disorder</em> de Mensen et collaborateurs (publi√© en 2017 dans la revue <em>Neuroimage: Clinical</em>, volume 13, pages 215 √† 222).
Celui-ci est disponible en libre acc√®s √† cette <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S2213158216302406">adresse</a>.
Les questions suivantes requi√®rent des r√©ponses √† d√©veloppement court.</p>
<ul class="simple">
<li><p>Quelle technique de neuroimagerie est utilis√©e? S‚Äôagit-il d‚Äôune technique structurelle ou fonctionnelle?</p></li>
<li><p>Est ce que le traitement des images inclut une(des) √©tape(s) de recalage? Si oui, de quel(s) type(s)?</p></li>
<li><p>Les chercheurs ont-ils mis en place une proc√©dure de contr√¥le qualit√©? Si oui, r√©sumez cette proc√©dure.</p></li>
<li><p>Les r√©gions d‚Äôint√©r√™t (ROI) sont-elles d√©finies? Si oui, de quelle fa√ßon? Avec quel atlas? Combien y en a-t-il?</p></li>
<li><p>Quelles mesures morphologiques sont utilis√©es pour chaque r√©gion?</p></li>
</ul>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="irm.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Imagerie par r√©sonance magn√©tique</p>
      </div>
    </a>
    <a class="right-next"
       href="irm_fonctionnelle.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">IRM fonctionnelle</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objectifs-du-cours">Objectifs du cours</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#morphometrie">Morphom√©trie</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#volumetrie">Volum√©trie</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#segmentation-manuelle">Segmentation manuelle</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#segmentation-automatique">Segmentation automatique</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analyses-statistiques">Analyses statistiques</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#controle-de-qualite">Contr√¥le de qualit√©</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vbm">VBM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#densite-de-matiere-grise">Densit√© de mati√®re grise</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#segmentation">Segmentation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lissage">Lissage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Analyses statistiques</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Contr√¥le de qualit√©</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analyses-de-surface">Analyses de surface</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extraction-de-surface">Extraction de surface</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#epaisseur-surface-et-volume">√âpaisseur, surface et volume</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Analyses statistiques</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Contr√¥le de qualit√©</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercices">Exercices</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Pierre Bellec et l'√©quipe PSY3018
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>