
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cartes statistiques &#8212; M√©thodes en neurosciences cognitives</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.e8f53015daec13862f6db5e763c41738.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="_static/favicon.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Reproductibilit√© et controverses" href="reproductibilite.html" />
    <link rel="prev" title="Imagerie optique" href="imagerie_optique.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">M√©thodes en neurosciences cognitives</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="cartes_cerebrales.html">
   Cartes c√©r√©brales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="irm.html">
   Imagerie par r√©sonance magn√©tique
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="morphometrie.html">
   Analyses morphom√©triques
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="irm_fonctionnelle.html">
   IRM fonctionnelle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="connectivite.html">
   Connectivit√© fonctionnelle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="irm_diffusion.html">
   IRM de diffusion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tep.html">
   Tomographie par √©mission de positrons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imagerie_optique.html">
   Imagerie optique
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Cartes statistiques
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reproductibilite.html">
   Reproductibilit√© et controverses
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="_sources/cartes_statistiques.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/cartes_statistiques.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/psy3018/notes_cours_psy3018/main?urlpath=tree/methodes_neurocog/cartes_statistiques.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#objectifs-du-cours">
   Objectifs du cours
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regression-lineaire">
   R√©gression lin√©aire
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variables">
     Variables
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#modele-lineaire">
     Mod√®le lin√©aire
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analyse-massivement-univariee">
     Analyse massivement univari√©e
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modele-lineaire-general">
   Mod√®le lin√©aire g√©n√©ral
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Variables
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regression-multiple">
     R√©gression multiple
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Cartes statistiques
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusion">
   Conclusion
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="cartes-statistiques">
<span id="cartes-statistiques-chapitre"></span><h1>Cartes statistiques<a class="headerlink" href="#cartes-statistiques" title="Permalink to this headline">¬∂</a></h1>
<table>
  <tr>
    <td align="center">
      <a href="https://github.com/elisabethloranger">
        <img src="https://avatars.githubusercontent.com/u/90270981?v=4?s=100" width="100px;" alt=""/>
        <br /><sub><b>√âlisabeth Loranger</b></sub>
      </a>
      <br />
        <a title="Contenu">ü§î</a>
    </td>
    <td align="center">
      <a href="https://github.com/pbellec">
        <img src="https://avatars.githubusercontent.com/u/1670887?v=4?s=100" width="100px;" alt=""/>
        <br /><sub><b>Pierre bellec</b></sub>
      </a>
      <br />
        <a title="Contenu">ü§î</a>
    </td>
  </tr>
</table>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Ce chapitre est en cours de d√©veloppement. Il se peut que l‚Äôinformation soit incompl√®te, ou sujette √† changement.</p>
</div>
<div class="section" id="objectifs-du-cours">
<h2>Objectifs du cours<a class="headerlink" href="#objectifs-du-cours" title="Permalink to this headline">¬∂</a></h2>
<p>On va parler du mod√®le de r√©gression pour g√©n√©rer des cartes statistiques c√©r√©brales de groupe. Les statistiques de groupe permettent de combiner les mesures du cerveau de plusieurs individus et ainsi de contraster des groupes (ex. groupe de personnes jeunes et groupe de personnes √¢g√©es) ou bien de tester l‚Äôassociation avec une variable continue (ex. l‚Äô√¢ge).</p>
<p>Les objectifs sp√©cifiques du cours sont les suivants :</p>
<ul class="simple">
<li><p>R√©gression lin√©aire.</p></li>
<li><p>Le mod√®le lin√©aire g√©n√©ral.</p></li>
<li><p>Comparaisons multiples.</p></li>
</ul>
</div>
<div class="section" id="regression-lineaire">
<h2>R√©gression lin√©aire<a class="headerlink" href="#regression-lineaire" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="variables">
<h3>Variables<a class="headerlink" href="#variables" title="Permalink to this headline">¬∂</a></h3>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importer les librairies</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiMasker</span>
<span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <span class="n">get_data</span>

<span class="c1"># Charge les donn√©es</span>
<span class="n">n_subjects</span> <span class="o">=</span> <span class="mi">100</span>  
<span class="n">oasis_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_oasis_vbm</span><span class="p">(</span><span class="n">n_subjects</span><span class="o">=</span><span class="n">n_subjects</span><span class="p">)</span>
<span class="n">gray_matter_map_filenames</span> <span class="o">=</span> <span class="n">oasis_dataset</span><span class="o">.</span><span class="n">gray_matter_maps</span>
<span class="n">age</span> <span class="o">=</span> <span class="n">oasis_dataset</span><span class="o">.</span><span class="n">ext_vars</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sex</span> <span class="o">=</span> <span class="n">oasis_dataset</span><span class="o">.</span><span class="n">ext_vars</span><span class="p">[</span><span class="s1">&#39;mf&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="sa">b</span><span class="s1">&#39;F&#39;</span>

<span class="c1"># On convertit les donn√©es en pandas dataframe</span>
<span class="c1"># Deux voxels int√©ressants ont √©t√© s√©lectionn√©s</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">29.</span><span class="p">,</span>  <span class="mf">10.</span><span class="p">,</span>   <span class="mf">4.</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">19.</span><span class="p">,</span>   <span class="mf">8.</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.</span><span class="p">]])</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;olive&#39;</span><span class="p">]</span>

<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">input_data</span>
<span class="n">masker</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">NiftiSpheresMasker</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
<span class="n">gm</span> <span class="o">=</span> <span class="n">masker</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">gray_matter_map_filenames</span><span class="p">)</span>
<span class="n">subject_label</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;sub-</span><span class="si">{</span><span class="n">num</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_subjects</span><span class="p">)]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;subject_label&quot;</span><span class="p">:</span> <span class="n">subject_label</span><span class="p">,</span>
    <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="n">age</span><span class="p">,</span>
    <span class="s2">&quot;sexe&quot;</span><span class="p">:</span> <span class="n">oasis_dataset</span><span class="o">.</span><span class="n">ext_vars</span><span class="p">[</span><span class="s1">&#39;mf&#39;</span><span class="p">],</span>
    <span class="s2">&quot;MG1&quot;</span><span class="p">:</span> <span class="n">gm</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;MG2&quot;</span><span class="p">:</span> <span class="n">gm</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="p">})</span>

<span class="n">df</span><span class="p">[</span><span class="s2">&quot;sexe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;sexe&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="sa">b</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;M&#39;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;femelle&#39;</span><span class="p">,</span> <span class="s1">&#39;male&#39;</span><span class="p">])</span>

<span class="c1"># On g√©n√®re la Figure</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>        
    <span class="n">nx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor_divide</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">ny</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">remainder</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">roi_img</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_anat</span><span class="p">(</span>
        <span class="n">gray_matter_map_filenames</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cut_coords</span><span class="o">=</span><span class="p">[</span><span class="n">coords</span><span class="p">[</span><span class="n">nx</span><span class="p">][</span><span class="mi">2</span><span class="p">]],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
        <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">roi_img</span><span class="o">.</span><span class="n">add_markers</span><span class="p">([</span><span class="n">coords</span><span class="p">[</span><span class="n">nx</span><span class="p">]],</span> <span class="n">colors</span><span class="p">[</span><span class="n">nx</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;darkgrid&quot;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;MG1&quot;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">binwidth</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">binrange</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;frequency&#39;</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;MG2&quot;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">binwidth</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">binrange</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;frequency&#39;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;vbm-distribution-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="vbm-distribution-fig" style="width: 800px">
<div class="cell_output docutils container">
<img alt="_images/cartes_statistiques_1_1.png" src="_images/cartes_statistiques_1_1.png" />
</div>
<p class="caption"><span class="caption-number">Fig. 93 </span><span class="caption-text">La position de deux voxels est illustr√©e avec un cercle bleu (haut) et olive (bas), de mani√®re superpos√©e avec des cartes de densit√© de mati√®re grise pour diff√©rents sujets du jeu de donn√©es OASIS (<a class="reference external" href="https://dx.doi.org/10.1162%2Fjocn.2009.21407">Marcus et al., 2010</a>). √Ä droite, un histograme repr√©sente la distribution de la densit√© de mati√®re grise pour le voxel correspondant, au travers de 100 sujets. Cette figure est adapt√©e d‚Äôun tutoriel de la librairie <a class="reference external" href="https://nilearn.github.io/auto_examples/05_glm_second_level/plot_oasis.html#sphx-glr-auto-examples-05-glm-second-level-plot-oasis-py">nilearn</a> (cliquer sur + pour voir le code). Cette figure est distribu√©e sous license <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a>.</span><a class="headerlink" href="#vbm-distribution-fig" title="Permalink to this image">¬∂</a></p>
</div>
<p>Les concepts pr√©sent√©s dans ce chapitre s‚Äôappliquent √† la plupart des modalit√©s d‚Äôimagerie vues dans le cours de fa√ßon plus ou moins identique. Mais afin de rendre les choses plus concr√®tes, nous allons nous int√©resser √† une analyse en morphom√©trie VBM √† l‚Äôaide de l‚ÄôIRM structurelle. Cette analyse utilise le jeu de donn√©es OASIS (<a class="reference external" href="https://dx.doi.org/10.1162%2Fjocn.2009.21407">Marcus et al., 2010</a>). Des cartes de densit√© de mati√®re grise pour les donn√©es OASIS sont disponibles via la librairie <a class="reference external" href="https://nilearn.github.io/modules/generated/nilearn.datasets.fetch_oasis_vbm.html">nilearn</a>. Pour chaque voxel, on dispose d‚Äôune mesure locale de densit√© de mati√®re grise, qui varie entre 0 et 1. Comme toutes les images des 100 participants OASIS utilis√©s dans cet exemple ont √©t√© recal√©es dans un m√™me espace st√©r√©otaxique, on a donc pour chaque voxel une s√©rie de 100 mesures. Il s‚Äôagit de notre <strong>variable d√©pendante</strong>, car on va chercher √† expliquer les variations de cette mesure au travers des sujets √† l‚Äôaide d‚Äôautres variables, dites <strong>pr√©dicteurs</strong>, et on va d√©marrer avec l‚Äô√¢ge des participants qui varie de 20 ans √† 90 ans.</p>
</div>
<div class="section" id="modele-lineaire">
<h3>Mod√®le lin√©aire<a class="headerlink" href="#modele-lineaire" title="Permalink to this headline">¬∂</a></h3>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># On r√©organise de DataFrame pour utiliser seaborn</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="s2">&quot;sexe&quot;</span><span class="p">],</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;MG1&quot;</span><span class="p">,</span> <span class="s2">&quot;MG2&quot;</span><span class="p">],</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;MG&quot;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;MG&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s1">&#39;variable&#39;</span><span class="p">,</span>
           <span class="n">ci</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># On colle la figure dans le jupyter book</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;regression-vbm-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>           
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="regression-vbm-fig" style="width: 800px">
<div class="cell_output docutils container">
<img alt="_images/cartes_statistiques_3_0.png" src="_images/cartes_statistiques_3_0.png" />
</div>
<p class="caption"><span class="caption-number">Fig. 94 </span><span class="caption-text">R√©gression lin√©aire, o√π la variable d√©pendante est la densit√© de mati√®re grise pour un voxel, et le pr√©dicteur est l‚Äô√¢ge. Les valeurs de densit√© de mati√®re grise proviennent de 100 sujets de la base de donn√©es OASIS (<a class="reference external" href="https://dx.doi.org/10.1162%2Fjocn.2009.21407">Marcus et al., 2010</a>), et les deux voxels sont pr√©sent√©s dans la <a class="reference internal" href="#vbm-distribution-fig"><span class="std std-numref">Fig. 93</span></a> (voxel bleu √† gauche, voxel olive √† droite). La r√©gression lin√©aire est r√©alis√©e √† l‚Äôaide de la libraire <a class="reference external" href="https://seaborn.pydata.org">seaborn</a> (cliquer sur + pour voir le code). Cette figure est distribu√©e sous license <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a>.</span><a class="headerlink" href="#regression-vbm-fig" title="Permalink to this image">¬∂</a></p>
</div>
<p>L‚Äôid√©e sous-jacente au mod√®le de r√©gression est une √©quation, ou une sorte de loi, qui va pr√©dire la variable d√©pendante, ici la densit√© de mati√®re grise, √† partir des pr√©dicteurs, disons l‚Äôage. Mais, contrairement √† une loi physique qui repr√©sente une d√©pendance exacte (dans un certain r√©gime), cette loi ne capture qu‚Äôune fraction de la variance de notre mesure. La loi va donc incorporer un bruit, qui repr√©sente toutes les sources de variabilit√© que l‚Äôon ne peut pas capturer avec notre relation. La relation math√©matique va prendre la forme suivante:</p>
<p><code class="docutils literal notranslate"><span class="pre">densite_matiere_grise</span> <span class="pre">=</span> <span class="pre">b0</span> <span class="pre">+</span> <span class="pre">b1</span> <span class="pre">*</span> <span class="pre">age</span> <span class="pre">+</span> <span class="pre">e</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">densite_matiere_grise</span></code> est la densit√© de mati√®re grise mesur√©e pour un voxel.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">age</span></code> est l‚Äô√¢ge du participant de recherche.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b0</span></code> est une valeur constante, appel√©e en anglais ‚Äúintercept‚Äù. Cette valeur est identique pour tous les sujets. Dans ce cas, elle repr√©sentrait la densit√© de mati√®re grise observ√©e √† la naissance (<code class="docutils literal notranslate"><span class="pre">age=0</span></code>), en moyenne sur la population.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b1</span></code> est une autre constante, qui dans ce cas mesure la r√©duction de mati√®re grise par ann√©e de vie (en moyenne sur la population).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">e</span></code> est un bruit de mesure, qui capture toutes les variations de <code class="docutils literal notranslate"><span class="pre">densite_matiere_grise</span></code> que l‚Äôon ne peut pas expliquer avec <code class="docutils literal notranslate"><span class="pre">age</span></code>. Typiquement on suppose que la moyenne de <code class="docutils literal notranslate"><span class="pre">e</span></code> dans la population est <code class="docutils literal notranslate"><span class="pre">0</span></code>, et que la variance de <code class="docutils literal notranslate"><span class="pre">e</span></code> est identique pour tous les sujets, √©gale √† <span class="math notranslate nohighlight">\(\sigma^2\)</span>.</p></li>
</ul>
<p>On ne connait √©videmment pas les coefficients <code class="docutils literal notranslate"><span class="pre">b0</span></code> et <code class="docutils literal notranslate"><span class="pre">b1</span></code>, et on doit utiliser une proc√©dure statistique pour les <code class="docutils literal notranslate"><span class="pre">estimer</span></code>, c‚Äôest √† dire deviner (au mieux) leurs valeurs √† partir des donn√©es dont on dispose. Par exemple, pour la r√©gion de couleur <code class="docutils literal notranslate"><span class="pre">olive</span></code> (graphe de droite dans <a class="reference internal" href="#regression-vbm-fig"><span class="std std-numref">Fig. 94</span></a>), on voit que l‚Äôon perd environ 25% de densit√© entre 20 ans et 90 ans, voir <a class="reference internal" href="#regression-vbm-fig"><span class="std std-numref">Fig. 94</span></a>. On perd donc environ 0.35% de densit√© de mati√®re grise par an, soit <code class="docutils literal notranslate"><span class="pre">b1</span> <span class="pre">~</span> <span class="pre">-0.0035</span></code>. En utilisant cette valeur et en remarquant que la densit√© de mati√®re grise est d‚Äô√† peu pr√®s <code class="docutils literal notranslate"><span class="pre">0.85</span></code> √† <code class="docutils literal notranslate"><span class="pre">20</span></code> ans, on en d√©duit que la densit√© √† la naissance devrait √™tre <code class="docutils literal notranslate"><span class="pre">b0=0.92</span></code>. En pratique la proc√©dure statistique va choisir les valeurs <code class="docutils literal notranslate"><span class="pre">b0</span></code> et <code class="docutils literal notranslate"><span class="pre">b1</span></code> pour minimiser l‚Äôamplitude des r√©sidus de la r√©gression:</p>
<p><code class="docutils literal notranslate"><span class="pre">residus</span> <span class="pre">=</span> <span class="pre">densite_matiere_grise</span> <span class="pre">-</span> <span class="pre">b0</span> <span class="pre">-</span> <span class="pre">b1</span> <span class="pre">*</span> <span class="pre">age</span></code></p>
<p>Une fois les coefficients <code class="docutils literal notranslate"><span class="pre">b0</span></code> et <code class="docutils literal notranslate"><span class="pre">b1</span></code> estim√©s, on peut tracer une droite qui repr√©sente les valeurs de densit√© de mati√®re grise pr√©dites √† partir de l‚Äô√¢ge des sujets, voir <a class="reference internal" href="#regression-vbm-fig"><span class="std std-numref">Fig. 94</span></a>. Si le mod√®le explique beaucoup de la variabilit√© de la variable d√©pendante, les points mesur√©s seront proches de la droite de pr√©diction.</p>
</div>
<div class="section" id="analyse-massivement-univariee">
<h3>Analyse massivement univari√©e<a class="headerlink" href="#analyse-massivement-univariee" title="Permalink to this headline">¬∂</a></h3>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn.glm.second_level</span> <span class="kn">import</span> <span class="n">make_second_level_design_matrix</span>
<span class="n">design_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;subject_label&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;femelle&#39;</span><span class="p">,</span> <span class="s1">&#39;male&#39;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">design_matrix</span> <span class="o">=</span> <span class="n">make_second_level_design_matrix</span><span class="p">(</span>
    <span class="n">subject_label</span><span class="p">,</span>
    <span class="n">design_df</span>
    <span class="p">)</span>
<span class="kn">from</span> <span class="nn">nilearn.glm.second_level</span> <span class="kn">import</span> <span class="n">SecondLevelModel</span>
<span class="n">second_level_model</span> <span class="o">=</span> <span class="n">SecondLevelModel</span><span class="p">(</span><span class="n">smoothing_fwhm</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<span class="n">second_level_model</span> <span class="o">=</span> <span class="n">second_level_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">gray_matter_map_filenames</span><span class="p">,</span>
                                            <span class="n">design_matrix</span><span class="o">=</span><span class="n">design_matrix</span><span class="p">)</span>
<span class="n">beta0</span> <span class="o">=</span> <span class="n">second_level_model</span><span class="o">.</span><span class="n">compute_contrast</span><span class="p">(</span><span class="n">second_level_contrast</span><span class="o">=</span><span class="s2">&quot;intercept&quot;</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s2">&quot;effect_size&quot;</span><span class="p">)</span>
<span class="n">beta1</span> <span class="o">=</span> <span class="n">second_level_model</span><span class="o">.</span><span class="n">compute_contrast</span><span class="p">(</span><span class="n">second_level_contrast</span><span class="o">=</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s2">&quot;effect_size&quot;</span><span class="p">)</span>

<span class="c1"># On g√©n√®re la Figure</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">roi_img</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span>
    <span class="n">beta0</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">gray_matter_map_filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cut_coords</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;intercept (b0)&#39;</span><span class="p">)</span>
<span class="n">roi_img</span><span class="o">.</span><span class="n">add_markers</span><span class="p">([</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">roi_img</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span>
    <span class="n">beta1</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">gray_matter_map_filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cut_coords</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;effet de l</span><span class="se">\&#39;</span><span class="s1">age (b1)&#39;</span><span class="p">)</span>
<span class="n">roi_img</span><span class="o">.</span><span class="n">add_markers</span><span class="p">([</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># On colle la figure dans le jupyter book</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;b0-b1-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>           
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="b0-b1-fig" style="width: 600px">
<div class="cell_output docutils container">
<img alt="_images/cartes_statistiques_5_0.png" src="_images/cartes_statistiques_5_0.png" />
</div>
<p class="caption"><span class="caption-number">Fig. 95 </span><span class="caption-text">Cartes de param√®tres statistiques dans une r√©gression lin√©aire massivement univari√©e. Premi√®re ligne: intercept <code class="docutils literal notranslate"><span class="pre">b0</span></code>, deuxi√®me ligne: effet lin√©aire de l‚Äô√¢ge <code class="docutils literal notranslate"><span class="pre">b1</span></code>. Cette figure est adapt√©e d‚Äôun tutoriel de la librairie <a class="reference external" href="https://nilearn.github.io/auto_examples/05_glm_second_level/plot_oasis.html#sphx-glr-auto-examples-05-glm-second-level-plot-oasis-py">nilearn</a> (cliquer sur + pour voir le code). Cette figure est distribu√©e sous license <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a>.</span><a class="headerlink" href="#b0-b1-fig" title="Permalink to this image">¬∂</a></p>
</div>
<p>On a pour l‚Äôinstant pr√©sent√© le mod√®le de r√©gression pour deux voxels seulement. Mais une carte VBM peut inclure des centaines de milliers de voxels. Les logiciels de neuroimagerie permettent d‚Äôeffectuer syst√©matiquement une r√©gression lin√©aire pour l‚Äôensemble des voxels, simultan√©ment. Dans ce cas, on estime deux param√®tres pour chaque voxel: <code class="docutils literal notranslate"><span class="pre">b0</span></code> (l‚Äôintercept) et <code class="docutils literal notranslate"><span class="pre">b1</span></code> (l‚Äôeffet de l‚Äô√¢ge). On va donc g√©n√©rer deux cartes statistiques s√©par√©es, voir <a class="reference internal" href="#b0-b1-fig"><span class="std std-numref">Fig. 95</span></a>. Ces deux cartes r√©capitulent donc des milliers de mod√®les de r√©gression diff√©rents. Comme les r√©gressions effectu√©es √† chaque voxel sont ind√©pendante les unes des autres, on parle de mod√®le univari√©, par opposition √† un mod√®le multivari√© qui cherche √† combiner les valeurs obtenues √† diff√©rents voxels. De plus, comme on fait un tr√®s grand nombre de r√©gressions en m√™me temps, on parle de r√©gression <strong>massivement univari√©e</strong>.</p>
<div class="tip admonition" id="stats-multimodales">
<p class="admonition-title">Statistiques et multimodalit√©</p>
<p>Le mod√®le de r√©gression est appliqu√© pour plusieurs modalit√©s de neuroimagerie. Dans cet exemple, on s‚Äôint√©resse √† la VBM. Mais le m√™me mod√®le fonctionne d√®s lors qu‚Äôon a une s√©rie de cartes pour diff√©rents sujets, et peut par exemple √™tre utilis√© en <a class="reference external" href="https://nilearn.github.io/auto_examples/05_glm_second_level/plot_oasis.html#sphx-glr-auto-examples-05-glm-second-level-plot-oasis-py">IRMf</a> ou bien en TEP. Le m√™me type de mod√®le peut aussi s‚Äôappliquer √† des mesures prises sur des r√©cepteurs en imagerie optique, ou des mesures moyennes sur un faisceau de fibres en IRMd. Le mod√®le de r√©gression est partout!</p>
</div>
</div>
</div>
<div class="section" id="modele-lineaire-general">
<h2>Mod√®le lin√©aire g√©n√©ral<a class="headerlink" href="#modele-lineaire-general" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="id1">
<h3>Variables<a class="headerlink" href="#id1" title="Permalink to this headline">¬∂</a></h3>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;ticks&quot;</span><span class="p">)</span>

<span class="c1"># Show the joint distribution using kernel density estimation</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;MG1&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;sexe&quot;</span><span class="p">,</span>
    <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;scatter&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># On colle la figure dans le jupyter book</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;age-sexe-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>           
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="age-sexe-fig" style="width: 600px">
<div class="cell_output docutils container">
<img alt="_images/cartes_statistiques_7_0.png" src="_images/cartes_statistiques_7_0.png" />
</div>
<p class="caption"><span class="caption-number">Fig. 96 </span><span class="caption-text">Relation entre √¢ge, sexe et densit√© de mati√®re grise pour un voxel (le voxel de couleur bleu dans <a class="reference internal" href="#vbm-distribution-fig"><span class="std std-numref">Fig. 93</span></a>). Le graphique est r√©alis√© √† l‚Äôaide de la libraire <a class="reference external" href="https://seaborn.pydata.org">seaborn</a> (cliquer sur + pour voir le code). Cette figure est distribu√©e sous license <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a>.</span><a class="headerlink" href="#age-sexe-fig" title="Permalink to this image">¬∂</a></p>
</div>
<p>L‚Äôapproche de r√©gression lin√©aire que l‚Äôon vient de voir est simple et puissante, mais elle est limit√©e √† deux variables. En neurosciences humaines, on ne se trouvera g√©n√©ralement pas dans ce cas. On va tr√®s souvent vouloir √©tudier des facteurs multiples de mani√®re conjointe. M√™me si la repr√©sentation du sexe des participants par une variable binaire est <a class="reference external" href="https://blogs.scientificamerican.com/sa-visual/visualizing-sex-as-a-spectrum/">tr√®s (tr√®s) simplificatrice</a> - sans compter la diversit√© de l‚Äôidentit√© de genre, nous allons quand m√™me essayer d‚Äôint√©grer le sexe (male vs femelle) dans notre analyse. La figure ci dessous montre les distributions d‚Äô√¢ge et de mati√®re grise (pour le voxel bleu), s√©par√©es par sexe. Ce graphique sugg√®re que la distribution de mati√®re grise est peut-√™tre diff√©rente entre male et femelle, mais cette diff√©rence pourrait √©galement √™tre li√©e √† l‚Äô√¢ge. Le mod√®le lin√©aire g√©n√©ral nous permet d‚Äôint√©grer toutes ces variables dans une seule analyse.</p>
</div>
<div class="section" id="regression-multiple">
<h3>R√©gression multiple<a class="headerlink" href="#regression-multiple" title="Permalink to this headline">¬∂</a></h3>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn.plotting</span> <span class="kn">import</span> <span class="n">plot_design_matrix</span>
<span class="n">design_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;subject_label&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="s2">&quot;sexe&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;femelle&#39;</span><span class="p">,</span> <span class="s1">&#39;male&#39;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">design_matrix</span> <span class="o">=</span> <span class="n">make_second_level_design_matrix</span><span class="p">(</span>
    <span class="n">subject_label</span><span class="p">,</span>
    <span class="n">design_df</span>
    <span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;MG1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">design_matrix</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;# sujet&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;MG&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;√Çge&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Sexe&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Intercept&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plot_design_matrix</span><span class="p">(</span><span class="n">design_matrix</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Matrice de dessein&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;# sujet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># On colle la figure dans le jupyter book</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;design-matrix-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>           
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="design-matrix-fig" style="width: 600px">
<div class="cell_output docutils container">
<img alt="_images/cartes_statistiques_9_0.png" src="_images/cartes_statistiques_9_0.png" />
</div>
<p class="caption"><span class="caption-number">Fig. 97 </span><span class="caption-text">Variables pour une r√©gression multiples. La variable d√©pendante est la densit√© de mati√®re grise pour un voxel (GM, le voxel de couleur bleu dans <a class="reference internal" href="#vbm-distribution-fig"><span class="std std-numref">Fig. 93</span></a>). Les autres colonnes repr√©sentent les variations de l‚Äô√¢ge, du sexe et de l‚Äôintercept au travers des sujets (variables pr√©dictives). Les variables pr√©dictives sent g√©n√©ralement repr√©sent√©es de mani√®re plus compact, sous la forme d‚Äôune image o√π la couleur de chaque pixel repr√©sente l‚Äôint√©nsit√© du r√©gresseur. Le graphique est adapt√© d‚Äôun <a class="reference external" href="https://dartbrains.org/content/GLM.html">code python</a> par l‚Äô√©quipe Dartbrains, ainsi que d‚Äôun <a class="reference external" href="https://nilearn.github.io/glm/first_level_model.html">tutoriel nilearn</a> (cliquer sur + pour voir le code). Cette figure est distribu√©e sous license <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a>.</span><a class="headerlink" href="#design-matrix-fig" title="Permalink to this image">¬∂</a></p>
</div>
<p>D‚Äôun point de vue math√©matique, le mod√®le de r√©gression multiple, parfois appel√© mod√®le lin√©aire g√©n√©ral, consiste simplement √† incorporer plus de variables dans la ‚Äúloi‚Äù qui pr√©dit la variable d√©pendante √† partir des r√©gresseurs:
<code class="docutils literal notranslate"><span class="pre">densite_matiere_grise</span> <span class="pre">=</span> <span class="pre">b0</span> <span class="pre">+</span> <span class="pre">b1</span> <span class="pre">*</span> <span class="pre">age</span> <span class="pre">+</span> <span class="pre">b2</span> <span class="pre">*</span> <span class="pre">sexe</span> <span class="pre">+</span> <span class="pre">e</span></code></p>
<p>Le seul nouveau coefficient est <code class="docutils literal notranslate"><span class="pre">b2</span></code>, qui dans ce cas mesure la diff√©rence entre la moyenne de mati√®re grise entre les femelles (cod√©es avec un 0 dans le mod√®le) et les males (cod√©s avec un 1 dans le mod√®le), <strong>apr√®s ajustement pour l‚Äô√¢ge des sujets</strong>. Ce type de codage pour donn√©es cat√©gorielles est appel√© ‚Äúdummy variable‚Äù en anglais, et permet d‚Äôint√©grer des tests de diff√©rences de moyenne entre groupe dans un mod√®le de r√©gression.</p>
<div class="tip admonition" id="stats-regression">
<p class="admonition-title">R√©gression multiple et statistiques classiques</p>
<p>Le mod√®le de r√©gression multiple est tr√®s flexible. Il est possible de formuler la plupart des tests classiques, tels que l‚Äôanalyse de variance (ANOVA) ou bien le test d‚Äô√©galit√© des moyennes de Student (t-test) √† l‚Äôaide du mod√®le de r√©gression lin√©aire. Voir ce <a class="reference external" href="https://lindeloev.github.io/tests-as-linear/">guide</a> pour plus de d√©tails.</p>
</div>
</div>
<div class="section" id="id2">
<h3>Cartes statistiques<a class="headerlink" href="#id2" title="Permalink to this headline">¬∂</a></h3>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">second_level_model</span> <span class="o">=</span> <span class="n">SecondLevelModel</span><span class="p">(</span><span class="n">smoothing_fwhm</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<span class="n">second_level_model</span> <span class="o">=</span> <span class="n">second_level_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">gray_matter_map_filenames</span><span class="p">,</span>
                                            <span class="n">design_matrix</span><span class="o">=</span><span class="n">design_matrix</span><span class="p">)</span>
<span class="n">beta0</span> <span class="o">=</span> <span class="n">second_level_model</span><span class="o">.</span><span class="n">compute_contrast</span><span class="p">(</span><span class="n">second_level_contrast</span><span class="o">=</span><span class="s2">&quot;intercept&quot;</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s2">&quot;effect_size&quot;</span><span class="p">)</span>
<span class="n">beta1</span> <span class="o">=</span> <span class="n">second_level_model</span><span class="o">.</span><span class="n">compute_contrast</span><span class="p">(</span><span class="n">second_level_contrast</span><span class="o">=</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s2">&quot;effect_size&quot;</span><span class="p">)</span>
<span class="n">beta2</span> <span class="o">=</span> <span class="n">second_level_model</span><span class="o">.</span><span class="n">compute_contrast</span><span class="p">(</span><span class="n">second_level_contrast</span><span class="o">=</span><span class="s2">&quot;sexe&quot;</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s2">&quot;effect_size&quot;</span><span class="p">)</span>

<span class="c1"># On g√©n√®re la Figure</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">roi_img</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span>
    <span class="n">beta0</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">gray_matter_map_filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cut_coords</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;intercept (b0)&#39;</span><span class="p">)</span>
<span class="n">roi_img</span><span class="o">.</span><span class="n">add_markers</span><span class="p">([</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">roi_img</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span>
    <span class="n">beta1</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">gray_matter_map_filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cut_coords</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;effet de l</span><span class="se">\&#39;</span><span class="s1">age (b1)&#39;</span><span class="p">)</span>
<span class="n">roi_img</span><span class="o">.</span><span class="n">add_markers</span><span class="p">([</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">roi_img</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span>
    <span class="n">beta2</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">gray_matter_map_filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cut_coords</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;effet du sexe (b2)&#39;</span><span class="p">)</span>
<span class="n">roi_img</span><span class="o">.</span><span class="n">add_markers</span><span class="p">([</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># On colle la figure dans le jupyter book</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;multi-regression-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>           
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="multi-regression-fig" style="width: 800px">
<div class="cell_output docutils container">
<img alt="_images/cartes_statistiques_11_0.png" src="_images/cartes_statistiques_11_0.png" />
</div>
<p class="caption"><span class="caption-number">Fig. 98 </span><span class="caption-text">Cartes de param√®tres statistiques dans une r√©gression lin√©aire multiple massivement univari√©e. Haut gauche: intercept <code class="docutils literal notranslate"><span class="pre">b0</span></code>, haut droite: effet lin√©aire de l‚Äô√¢ge <code class="docutils literal notranslate"><span class="pre">b1</span></code>, bas gauche: effet lin√©aire du sexe <code class="docutils literal notranslate"><span class="pre">b2</span></code>. Cette figure est adapt√©e d‚Äôun tutoriel de la librairie <a class="reference external" href="https://nilearn.github.io/auto_examples/05_glm_second_level/plot_oasis.html#sphx-glr-auto-examples-05-glm-second-level-plot-oasis-py">nilearn</a> (cliquer sur + pour voir le code). Cette figure est distribu√©e sous license <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a>.</span><a class="headerlink" href="#multi-regression-fig" title="Permalink to this image">¬∂</a></p>
</div>
<p>Une caract√©ristique un peu contre-intuitive avec la r√©gression multiple est que la carte d‚Äôeffet de l‚Äô√¢ge est diff√©rente de la section avec la r√©gression simple. En effet, l‚Äôeffet de l‚Äô√¢ge est maintenant √©valu√© <em>apr√®s avoir pris en compte des diff√©rences de sexe</em>. Malgr√© cela, le r√©sultat de la r√©gression n‚Äôa pas chang√© de mani√®re frappante: le cortex s‚Äôatrophie avec l‚Äô√¢ge (en bleu), alors que le liquide c√©phalo-rachidien s‚Äô√©tend ce qui apparait comme une expansion de la mati√®re grise √† cause des effets de volume partiel (en rouge). L‚Äôanalyse sur la variable de <code class="docutils literal notranslate"><span class="pre">sexe</span></code> montre que la densit√© de mati√®re grise est plus √©lev√©e (en moyenne) dans le cortex chez les hommes, alors que la tendance est invers√©e au niveau du cervelet.</p>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¬∂</a></h2>
<p>En g√©n√©rale quand on parle de l‚ÄôIRMf ou m√™me de la VBM, on trouve des blobs qui pr√©sentent des effets significatifs. Ce qui est important de se rappeler est toute la s√©rie d‚Äô√©tapes qui m√®nent √† ce type de carte.</p>
<ol class="simple">
<li><p>La premi√®re, l‚Äôhypoth√®se psychologique : 	On avait commenc√© le cours avec ces deux t√¢ches avec les visages qui expriment les √©motions et des stimuli contr√¥les. Notre est hypoth√®se est que ce sont les visages qui expliquent le patron d‚Äôactivation observ√©.</p></li>
<li><p>Ensuite, on a des hypoth√®ses au niveau neuronal : On √©met des hypoth√®ses au sujet du type de r√©ponse neuronale observ√©. En IRMf, on √©met l‚Äôhypoth√®se que l‚Äôactivation atteint son plafond quand la stimulation est d√©but√©e et qu‚Äôelle retombe √† 0 une fois le bloc termin√©.</p></li>
<li><p>Finalement, on a des hypoth√®ses h√©modynamiques : On va supposer que l‚Äôactivit√© BOLD enregistr√©e en IRMf va correspondre √† l‚Äôactivit√© neuronale.</p></li>
</ol>
<p>√Ä la fin, on aura des √©tapes d‚Äôanalyses d‚Äôimages, de recalage, de d√©bruitage et de mod√©lisation statistique.</p>
<p>Ainsi, il y a beaucoup de choses, de choix et d‚Äôhypoth√®ses qui vont derri√®re ce petit blob rouge qui ressort dans des cartes statistiques.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="imagerie_optique.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Imagerie optique</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="reproductibilite.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Reproductibilit√© et controverses</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Pierre Bellec et l'√©quipe PSY3018<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>