

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Cartes statistiques &#8212; M√©thodes en neurosciences cognitives</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'cartes_statistiques';</script>
    <link rel="shortcut icon" href="_static/favicon.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Reproductibilit√© et controverses" href="reproductibilite.html" />
    <link rel="prev" title="Tomographie par √©mission de positrons" href="tep.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="cartes_cerebrales.html">Cartes c√©r√©brales</a></li>
<li class="toctree-l1"><a class="reference internal" href="irm.html">Imagerie par r√©sonance magn√©tique</a></li>
<li class="toctree-l1"><a class="reference internal" href="morphometrie.html">Analyses morphom√©triques</a></li>
<li class="toctree-l1"><a class="reference internal" href="irm_fonctionnelle.html">IRM fonctionnelle</a></li>
<li class="toctree-l1"><a class="reference internal" href="connectivite.html">Connectivit√© fonctionnelle</a></li>
<li class="toctree-l1"><a class="reference internal" href="irm_diffusion.html">IRM de diffusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="imagerie_optique.html">Imagerie optique</a></li>
<li class="toctree-l1"><a class="reference internal" href="tep.html">Tomographie par √©mission de positrons</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Cartes statistiques</a></li>
<li class="toctree-l1"><a class="reference internal" href="reproductibilite.html">Reproductibilit√© et controverses</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">R√©f√©rences</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/psy3018/notes_cours_psy3018" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/psy3018/notes_cours_psy3018/edit/main/methodes_neurocog/cartes_statistiques.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/psy3018/notes_cours_psy3018/issues/new?title=Issue%20on%20page%20%2Fcartes_statistiques.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/cartes_statistiques.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Cartes statistiques</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objectifs-du-cours">Objectifs du cours</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-lineaire">R√©gression lin√©aire</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variables">Variables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modele-lineaire">Mod√®le lin√©aire</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analyse-massivement-univariee">Analyse massivement univari√©e</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modele-lineaire-general">Mod√®le lin√©aire g√©n√©ral</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Variables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-multiple">R√©gression multiple</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Cartes statistiques</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tests-statistiques">Tests statistiques</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tests-t-et-valeur-p">Tests t et valeur p</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothese-nulle">Hypoth√®se nulle</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparaisons-multiples">Comparaisons multiples</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercices">Exercices</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="cartes-statistiques">
<span id="cartes-statistiques-chapitre"></span><h1>Cartes statistiques<a class="headerlink" href="#cartes-statistiques" title="Permalink to this heading">#</a></h1>
<table>
  <tr>
    <td align="center">
      <a href="https://github.com/elisabethloranger">
        <img src="https://avatars.githubusercontent.com/u/90270981?v=4?s=100" width="100px;" alt=""/>
        <br /><sub><b>√âlisabeth Loranger</b></sub>
      </a>
      <br />
        <a title="Contenu">ü§î</a>
    </td>
    <td align="center">
      <a href="https://github.com/pbellec">
        <img src="https://avatars.githubusercontent.com/u/1670887?v=4?s=100" width="100px;" alt=""/>
        <br /><sub><b>Pierre bellec</b></sub>
      </a>
      <br />
        <a title="Contenu">ü§î</a>
    </td>
    <td align="center">
      <a href="https://github.com/eddyfortier">
        <img src="https://avatars.githubusercontent.com/u/72314243?v=4?s=100" width="100px;" alt=""/>
        <br /><sub><b>Eddy Fortier</b></sub>
      </a>
      <br />
        <a title="R√©vision du texte">üëÄ</a>
    </td>
  </tr>
</table>
<section id="objectifs-du-cours">
<h2>Objectifs du cours<a class="headerlink" href="#objectifs-du-cours" title="Permalink to this heading">#</a></h2>
<p>Dans ce chapitre, il sera question de l‚Äôutilisation du mod√®le de r√©gression pour g√©n√©rer des cartes statistiques c√©r√©brales de groupe. Les statistiques de groupe permettent de combiner les mesures du cerveau de plusieurs individus et ainsi de contraster des groupes (ex. groupe de personnes jeunes et groupe de personnes √¢g√©es) ou bien de tester l‚Äôassociation avec une variable continue (ex. l‚Äô√¢ge).</p>
<p>Les objectifs sp√©cifiques du cours portent sur les concepts suivants :</p>
<ul class="simple">
<li><p>la r√©gression lin√©aire,</p></li>
<li><p>le mod√®le lin√©aire g√©n√©ral,</p></li>
<li><p>tests statistiques.</p></li>
</ul>
</section>
<section id="regression-lineaire">
<h2>R√©gression lin√©aire<a class="headerlink" href="#regression-lineaire" title="Permalink to this heading">#</a></h2>
<section id="variables">
<h3>Variables<a class="headerlink" href="#variables" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importer les librairies</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiMasker</span>
<span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <span class="n">get_data</span>

<span class="c1"># Charger les donn√©es</span>
<span class="n">n_subjects</span> <span class="o">=</span> <span class="mi">100</span>  
<span class="n">oasis_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_oasis_vbm</span><span class="p">(</span><span class="n">n_subjects</span><span class="o">=</span><span class="n">n_subjects</span><span class="p">)</span>
<span class="n">gray_matter_map_filenames</span> <span class="o">=</span> <span class="n">oasis_dataset</span><span class="o">.</span><span class="n">gray_matter_maps</span>
<span class="n">age</span> <span class="o">=</span> <span class="n">oasis_dataset</span><span class="o">.</span><span class="n">ext_vars</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sex</span> <span class="o">=</span> <span class="n">oasis_dataset</span><span class="o">.</span><span class="n">ext_vars</span><span class="p">[</span><span class="s1">&#39;mf&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="sa">b</span><span class="s1">&#39;F&#39;</span>

<span class="c1"># Conversion des donn√©es en pandas dataframe</span>
<span class="c1"># Deux voxels int√©ressants ont √©t√© s√©lectionn√©s</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">29.</span><span class="p">,</span>  <span class="mf">10.</span><span class="p">,</span>   <span class="mf">4.</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">19.</span><span class="p">,</span>   <span class="mf">8.</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.</span><span class="p">]])</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;olive&#39;</span><span class="p">]</span>

<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">input_data</span>
<span class="n">masker</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">NiftiSpheresMasker</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
<span class="n">gm</span> <span class="o">=</span> <span class="n">masker</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">gray_matter_map_filenames</span><span class="p">)</span>
<span class="n">subject_label</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;sub-</span><span class="si">{</span><span class="n">num</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_subjects</span><span class="p">)]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;subject_label&quot;</span><span class="p">:</span> <span class="n">subject_label</span><span class="p">,</span>
    <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="n">age</span><span class="p">,</span>
    <span class="s2">&quot;sexe&quot;</span><span class="p">:</span> <span class="n">oasis_dataset</span><span class="o">.</span><span class="n">ext_vars</span><span class="p">[</span><span class="s1">&#39;mf&#39;</span><span class="p">],</span>
    <span class="s2">&quot;MG1&quot;</span><span class="p">:</span> <span class="n">gm</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;MG2&quot;</span><span class="p">:</span> <span class="n">gm</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="p">})</span>

<span class="n">df</span><span class="p">[</span><span class="s2">&quot;sexe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;sexe&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="sa">b</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;M&#39;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;femelle&#39;</span><span class="p">,</span> <span class="s1">&#39;male&#39;</span><span class="p">])</span>

<span class="c1"># On g√©n√®re la Figure</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>        
    <span class="n">nx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor_divide</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">ny</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">remainder</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">roi_img</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_anat</span><span class="p">(</span>
        <span class="n">gray_matter_map_filenames</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cut_coords</span><span class="o">=</span><span class="p">[</span><span class="n">coords</span><span class="p">[</span><span class="n">nx</span><span class="p">][</span><span class="mi">2</span><span class="p">]],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
        <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">roi_img</span><span class="o">.</span><span class="n">add_markers</span><span class="p">([</span><span class="n">coords</span><span class="p">[</span><span class="n">nx</span><span class="p">]],</span> <span class="n">colors</span><span class="p">[</span><span class="n">nx</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;darkgrid&quot;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;MG1&quot;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">binwidth</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">binrange</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;frequency&#39;</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;MG2&quot;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">binwidth</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">binrange</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;frequency&#39;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;vbm-distribution-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="vbm-distribution-fig" style="width: 800px">
<img alt="_images/ef348896b1b54e00d3553520f993d72db1f6b095dda4c95e8c59d89f7dcc286b.png" src="_images/ef348896b1b54e00d3553520f993d72db1f6b095dda4c95e8c59d89f7dcc286b.png" />
<figcaption>
<p><span class="caption-number">Fig. 99 </span><span class="caption-text">La position de deux voxels (illustr√©e √† l‚Äôaide d‚Äôun cercle bleu (haut) et d‚Äôun cercle olive (bas)) est ici superpos√©e sur des cartes de densit√© de mati√®re grise pour diff√©rents sujets du jeu de donn√©es OASIS (<a class="reference external" href="https://dx.doi.org/10.1162%2Fjocn.2009.21407">Marcus et al., 2010</a>). √Ä droite, un histogramme repr√©sente la distribution de la densit√© de mati√®re grise pour le voxel correspondant, √† travers un √©chantillon de 100 sujets. Cette figure est adapt√©e d‚Äôun tutoriel de la librairie <a class="reference external" href="https://nilearn.github.io/auto_examples/05_glm_second_level/plot_oasis.html#sphx-glr-auto-examples-05-glm-second-level-plot-oasis-py">nilearn</a> (cliquer sur + pour voir le code). Cette figure est distribu√©e sous licence <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a>.</span><a class="headerlink" href="#vbm-distribution-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Les concepts pr√©sent√©s dans ce chapitre s‚Äôappliquent √† la plupart des modalit√©s d‚Äôimagerie vues dans le cours de fa√ßon plus ou moins identique. Afin de rendre les choses un peu plus concr√®tes, nous allons ici nous int√©resser √† une analyse morphom√©trique de type VBM (IRM structurelle). Cette analyse utilise le jeu de donn√©es OASIS (<a class="reference external" href="https://dx.doi.org/10.1162%2Fjocn.2009.21407">Marcus et al., 2010</a>). Des cartes de densit√© de mati√®re grise pour les donn√©es OASIS sont disponibles via la librairie <a class="reference external" href="https://nilearn.github.io/modules/generated/nilearn.datasets.fetch_oasis_vbm.html">nilearn</a>. Pour chaque voxel, on dispose d‚Äôune mesure locale de densit√© de mati√®re grise qui varie entre 0 et 1. Comme toutes les images des 100 participants OASIS utilis√©s dans cet exemple ont √©t√© recal√©es dans un m√™me espace st√©r√©otaxique, chaque voxel est associ√© √† une s√©rie de 100 mesures. Il s‚Äôagit de notre <strong>variable d√©pendante</strong>. On va par la suite chercher √† expliquer les variations de cette mesure √† travers les sujets √† l‚Äôaide d‚Äôautres variables, appel√©es les <strong>pr√©dicteurs</strong>. Pour notre exemple, nous allons d√©marrer avec l‚Äô√¢ge des participants qui varie ici de 20 ans √† 90 ans.</p>
</section>
<section id="modele-lineaire">
<h3>Mod√®le lin√©aire<a class="headerlink" href="#modele-lineaire" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># On r√©organise le DataFrame pour utiliser seaborn</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="s2">&quot;sexe&quot;</span><span class="p">],</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;MG1&quot;</span><span class="p">,</span> <span class="s2">&quot;MG2&quot;</span><span class="p">],</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;MG&quot;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;MG&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s1">&#39;variable&#39;</span><span class="p">,</span>
           <span class="n">ci</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># On colle la figure dans le jupyter book</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;regression-vbm-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>           
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="regression-vbm-fig" style="width: 800px">
<img alt="_images/88980be9ad2ed91e2bc8e745fe937a0d19e93a786113eabc72e0a9f007dc982d.png" src="_images/88980be9ad2ed91e2bc8e745fe937a0d19e93a786113eabc72e0a9f007dc982d.png" />
<figcaption>
<p><span class="caption-number">Fig. 100 </span><span class="caption-text">Exemple de r√©gression lin√©aire o√π la variable d√©pendante est la densit√© de mati√®re grise pour un voxel et le pr√©dicteur est l‚Äô√¢ge. Les valeurs de densit√© de mati√®re grise proviennent de 100 sujets de la base de donn√©es OASIS (<a class="reference external" href="https://dx.doi.org/10.1162%2Fjocn.2009.21407">Marcus et al., 2010</a>). Les deux voxels utilis√©s ici sont les m√™mes que ceux repr√©sent√©s dans la <a class="reference internal" href="#vbm-distribution-fig"><span class="std std-numref">Fig. 99</span></a> (voxel bleu √† gauche, voxel olive √† droite). La r√©gression lin√©aire est r√©alis√©e √† l‚Äôaide de la libraire <a class="reference external" href="https://seaborn.pydata.org">seaborn</a> (cliquer sur + pour voir le code). Cette figure est distribu√©e sous licence <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a>.</span><a class="headerlink" href="#regression-vbm-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Le concept soutenant le mod√®le de r√©gression est une √©quation, ou une sorte de loi, qui va tenter de pr√©dire la variable d√©pendante (ici, la densit√© de mati√®re grise) √† partir de pr√©dicteurs (par exemple, l‚Äô√¢ge). Mais contrairement √† une loi physique qui tente de repr√©senter une d√©pendance exacte (jusqu‚Äô√† un certain degr√©), la pr√©sente loi ne capture qu‚Äôune fraction de la variance de notre mesure. La loi va donc incorporer un certain bruit repr√©sentant toutes les sources de variabilit√© que l‚Äôon ne peut pas capturer avec notre relation. La relation math√©matique va prendre la forme suivante:</p>
<p><code class="docutils literal notranslate"><span class="pre">densite_matiere_grise</span> <span class="pre">=</span> <span class="pre">b0</span> <span class="pre">+</span> <span class="pre">b1</span> <span class="pre">*</span> <span class="pre">age</span> <span class="pre">+</span> <span class="pre">e</span></code></p>
<p>O√π</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">densite_matiere_grise</span></code> est la densit√© de mati√®re grise mesur√©e pour un voxel</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">age</span></code> est l‚Äô√¢ge du participant de recherche</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b0</span></code> est une valeur constante, appel√©e en anglais ‚Äúintercept‚Äù (l‚Äôordonn√©e √† l‚Äôorigine). Cette valeur est identique pour tous les sujets. Dans ce cas-ci, elle repr√©senterait la densit√© de mati√®re grise observ√©e √† la naissance (<code class="docutils literal notranslate"><span class="pre">age=0</span></code>), en moyenne sur la population.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b1</span></code> est une autre constante qui dans cet exemple mesure la r√©duction de mati√®re grise par ann√©e de vie (en moyenne sur la population).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">e</span></code> est un bruit de mesure qui capture toutes les variations de <code class="docutils literal notranslate"><span class="pre">densite_matiere_grise</span></code> que l‚Äôon ne peut pas expliquer avec <code class="docutils literal notranslate"><span class="pre">age</span></code>. Typiquement, on suppose que la moyenne de <code class="docutils literal notranslate"><span class="pre">e</span></code> dans la population est <code class="docutils literal notranslate"><span class="pre">0</span></code> et que la variance de <code class="docutils literal notranslate"><span class="pre">e</span></code> est identique pour tous les sujets, √©gale √† <span class="math notranslate nohighlight">\(\sigma^2\)</span>.</p></li>
</ul>
<p>On ne conna√Æt √©videmment pas les coefficients <code class="docutils literal notranslate"><span class="pre">b0</span></code> et <code class="docutils literal notranslate"><span class="pre">b1</span></code>. Il sera n√©cessaire d‚Äôutiliser une proc√©dure statistique pour les <code class="docutils literal notranslate"><span class="pre">estimer</span></code>, c‚Äôest-√†-dire deviner (au mieux) leurs valeurs √† partir des donn√©es dont nous disposons. Par exemple, pour la r√©gion de couleur <code class="docutils literal notranslate"><span class="pre">olive</span></code> (graphe de droite dans <a class="reference internal" href="#regression-vbm-fig"><span class="std std-numref">Fig. 100</span></a>), on voit que l‚Äôon perd environ 25% de densit√© entre 20 ans et 90 ans (voir <a class="reference internal" href="#regression-vbm-fig"><span class="std std-numref">Fig. 100</span></a>). On perd donc environ 0.35% de densit√© de mati√®re grise par an, soit <code class="docutils literal notranslate"><span class="pre">b1</span> <span class="pre">~</span> <span class="pre">-0.0035</span></code>. En utilisant cette valeur et en remarquant que la densit√© de mati√®re grise est d‚Äô√† peu pr√®s <code class="docutils literal notranslate"><span class="pre">0.85</span></code> √† <code class="docutils literal notranslate"><span class="pre">20</span></code> ans, on en d√©duit que la densit√© √† la naissance devrait √™tre <code class="docutils literal notranslate"><span class="pre">b0=0.92</span></code>. En pratique, la proc√©dure statistique va choisir les valeurs <code class="docutils literal notranslate"><span class="pre">b0</span></code> et <code class="docutils literal notranslate"><span class="pre">b1</span></code> pour minimiser l‚Äôamplitude des r√©sidus de la r√©gression:</p>
<p><code class="docutils literal notranslate"><span class="pre">residus</span> <span class="pre">=</span> <span class="pre">densite_matiere_grise</span> <span class="pre">-</span> <span class="pre">b0</span> <span class="pre">-</span> <span class="pre">b1</span> <span class="pre">*</span> <span class="pre">age</span></code></p>
<p>Une fois les coefficients <code class="docutils literal notranslate"><span class="pre">b0</span></code> et <code class="docutils literal notranslate"><span class="pre">b1</span></code> estim√©s, on peut tracer une droite qui repr√©sente les valeurs de densit√© de mati√®re grise pr√©dites √† partir de l‚Äô√¢ge des sujets (voir <a class="reference internal" href="#regression-vbm-fig"><span class="std std-numref">Fig. 100</span></a>). Si le mod√®le permet d‚Äôexpliquer une partie importante de la variabilit√© de la variable d√©pendante, les points mesur√©s seront proches de la droite de pr√©diction.</p>
</section>
<section id="analyse-massivement-univariee">
<h3>Analyse massivement univari√©e<a class="headerlink" href="#analyse-massivement-univariee" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn.glm.second_level</span> <span class="kn">import</span> <span class="n">make_second_level_design_matrix</span>
<span class="n">design_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;subject_label&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;femelle&#39;</span><span class="p">,</span> <span class="s1">&#39;male&#39;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
<span class="n">design_matrix</span> <span class="o">=</span> <span class="n">make_second_level_design_matrix</span><span class="p">(</span>
    <span class="n">subject_label</span><span class="p">,</span>
    <span class="n">design_df</span>
    <span class="p">)</span>
<span class="kn">from</span> <span class="nn">nilearn.glm.second_level</span> <span class="kn">import</span> <span class="n">SecondLevelModel</span>
<span class="n">second_level_model</span> <span class="o">=</span> <span class="n">SecondLevelModel</span><span class="p">(</span><span class="n">smoothing_fwhm</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<span class="n">second_level_model</span> <span class="o">=</span> <span class="n">second_level_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">gray_matter_map_filenames</span><span class="p">,</span>
                                            <span class="n">design_matrix</span><span class="o">=</span><span class="n">design_matrix</span><span class="p">)</span>
<span class="n">beta0</span> <span class="o">=</span> <span class="n">second_level_model</span><span class="o">.</span><span class="n">compute_contrast</span><span class="p">(</span><span class="n">second_level_contrast</span><span class="o">=</span><span class="s2">&quot;intercept&quot;</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s2">&quot;effect_size&quot;</span><span class="p">)</span>
<span class="n">beta1</span> <span class="o">=</span> <span class="n">second_level_model</span><span class="o">.</span><span class="n">compute_contrast</span><span class="p">(</span><span class="n">second_level_contrast</span><span class="o">=</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s2">&quot;effect_size&quot;</span><span class="p">)</span>

<span class="c1"># On g√©n√®re la Figure</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">roi_img</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span>
    <span class="n">beta0</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">gray_matter_map_filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cut_coords</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;intercept (b0)&#39;</span><span class="p">)</span>
<span class="n">roi_img</span><span class="o">.</span><span class="n">add_markers</span><span class="p">([</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">roi_img</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span>
    <span class="n">beta1</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">gray_matter_map_filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cut_coords</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;effet de l</span><span class="se">\&#39;</span><span class="s1">age (b1)&#39;</span><span class="p">)</span>
<span class="n">roi_img</span><span class="o">.</span><span class="n">add_markers</span><span class="p">([</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># On colle la figure dans le jupyter book</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;b0-b1-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>           
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="b0-b1-fig" style="width: 600px">
<img alt="_images/8fa71dfcd9c0ed6bd75add5d51590dfe8154baf7c7441cba1dcbeaca8a5dfd7a.png" src="_images/8fa71dfcd9c0ed6bd75add5d51590dfe8154baf7c7441cba1dcbeaca8a5dfd7a.png" />
<figcaption>
<p><span class="caption-number">Fig. 101 </span><span class="caption-text">Cartes de param√®tres statistiques dans une r√©gression lin√©aire massivement univari√©e. Premi√®re ligne: intercept <code class="docutils literal notranslate"><span class="pre">b0</span></code>, deuxi√®me ligne: effet lin√©aire de l‚Äô√¢ge <code class="docutils literal notranslate"><span class="pre">b1</span></code>. Cette figure est adapt√©e d‚Äôun tutoriel de la librairie <a class="reference external" href="https://nilearn.github.io/auto_examples/05_glm_second_level/plot_oasis.html#sphx-glr-auto-examples-05-glm-second-level-plot-oasis-py">nilearn</a> (cliquer sur + pour voir le code). Cette figure est distribu√©e sous licence <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a>.</span><a class="headerlink" href="#b0-b1-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Pour l‚Äôinstant, nous avons utilis√© un mod√®le de r√©gression pour deux voxels seulement. Mais une carte VBM peut inclure des centaines de milliers de voxels. Les logiciels de neuroimagerie permettent d‚Äôeffectuer syst√©matiquement une r√©gression lin√©aire pour l‚Äôensemble des voxels, simultan√©ment. Dans ce cas, on estime deux param√®tres pour chaque voxel: <code class="docutils literal notranslate"><span class="pre">b0</span></code> (l‚Äôintercept) et <code class="docutils literal notranslate"><span class="pre">b1</span></code> (l‚Äôeffet de l‚Äô√¢ge). On va donc g√©n√©rer deux cartes statistiques s√©par√©es (voir <a class="reference internal" href="#b0-b1-fig"><span class="std std-numref">Fig. 101</span></a>). Ces deux cartes r√©capitulent donc des milliers de mod√®les de r√©gression diff√©rents. Comme les r√©gressions effectu√©es √† chaque voxel sont ind√©pendantes les unes des autres, on parle de mod√®le univari√©. L‚Äôautre option, le mod√®le multivari√©, chercherait plut√¥t √† combiner les valeurs obtenues √† diff√©rents voxels. De plus, comme on fait un tr√®s grand nombre de r√©gressions en m√™me temps, on parle de r√©gression <strong>massivement univari√©e</strong>.</p>
<div class="tip admonition" id="stats-multimodales">
<p class="admonition-title">Statistiques et multimodalit√©</p>
<p>Le mod√®le de r√©gression est appliqu√© √† plusieurs modalit√©s de neuroimagerie. Dans ce chapitre, il est question d‚Äôun exemple utilisant la VBM. Mais le m√™me mod√®le fonctionne d√®s lors qu‚Äôon a une s√©rie de cartes pour diff√©rents sujets. Il pourrait par exemple √™tre utilis√© en <a class="reference external" href="https://nilearn.github.io/auto_examples/05_glm_second_level/plot_second_level_one_sample_test.html#sphx-glr-auto-examples-05-glm-second-level-plot-second-level-one-sample-test-py">IRMf</a> ou bien en TEP. Le m√™me type de mod√®le peut aussi s‚Äôappliquer √† des mesures prises sur des r√©cepteurs en imagerie optique ou des mesures moyennes sur un faisceau de fibres en IRMd. Le mod√®le de r√©gression est partout!</p>
</div>
</section>
</section>
<section id="modele-lineaire-general">
<h2>Mod√®le lin√©aire g√©n√©ral<a class="headerlink" href="#modele-lineaire-general" title="Permalink to this heading">#</a></h2>
<section id="id1">
<h3>Variables<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;ticks&quot;</span><span class="p">)</span>

<span class="c1"># Show the joint distribution using kernel density estimation</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;MG1&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;sexe&quot;</span><span class="p">,</span>
    <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;scatter&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># On colle la figure dans le jupyter book</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;age-sexe-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>           
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="age-sexe-fig" style="width: 600px">
<img alt="_images/4257c32af8da3836220ba11a3851595c99489f42495c4808cfb9702b78f154d3.png" src="_images/4257c32af8da3836220ba11a3851595c99489f42495c4808cfb9702b78f154d3.png" />
<figcaption>
<p><span class="caption-number">Fig. 102 </span><span class="caption-text">Relation entre √¢ge, sexe et densit√© de mati√®re grise pour un voxel (le voxel de couleur bleu dans <a class="reference internal" href="#vbm-distribution-fig"><span class="std std-numref">Fig. 99</span></a>). Le graphique est r√©alis√© √† l‚Äôaide de la libraire <a class="reference external" href="https://seaborn.pydata.org">seaborn</a> (cliquer sur + pour voir le code). Cette figure est distribu√©e sous licence <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a>.</span><a class="headerlink" href="#age-sexe-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>L‚Äôapproche de r√©gression lin√©aire que l‚Äôon vient de voir est simple et puissante, mais elle est limit√©e √† deux variables. En neurosciences humaines, on ne se trouvera g√©n√©ralement pas dans ce cas. On va tr√®s souvent vouloir √©tudier des facteurs multiples de mani√®re conjointe. M√™me si la repr√©sentation du sexe des participants par une variable binaire est <a class="reference external" href="https://blogs.scientificamerican.com/sa-visual/visualizing-sex-as-a-spectrum/">tr√®s (tr√®s) simplificatrice</a> - sans compter la diversit√© de l‚Äôidentit√© de genre - nous allons quand m√™me essayer d‚Äôint√©grer le sexe (m√¢le vs femelle) dans notre analyse. La figure ci-dessus montre les distributions d‚Äô√¢ge et de mati√®re grise (pour le voxel bleu), s√©par√©es par sexe. Ce graphique sugg√®re que la distribution de mati√®re grise est peut-√™tre diff√©rente entre m√¢le et femelle, mais cette diff√©rence pourrait √©galement √™tre li√©e √† l‚Äô√¢ge. Le mod√®le lin√©aire g√©n√©ral nous permet d‚Äôint√©grer toutes ces variables dans une seule analyse.</p>
</section>
<section id="regression-multiple">
<h3>R√©gression multiple<a class="headerlink" href="#regression-multiple" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn.plotting</span> <span class="kn">import</span> <span class="n">plot_design_matrix</span>
<span class="n">design_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;subject_label&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="s2">&quot;sexe&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
<span class="n">design_matrix</span> <span class="o">=</span> <span class="n">make_second_level_design_matrix</span><span class="p">(</span>
    <span class="n">subject_label</span><span class="p">,</span>
    <span class="n">design_df</span>
    <span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;MG1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">design_matrix</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;# sujet&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;MG&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39; ge&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Sexe&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Intercept&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plot_design_matrix</span><span class="p">(</span><span class="n">design_matrix</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Matrice de dessein&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;# sujet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># On colle la figure dans le jupyter book</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;design-matrix-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>           
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="design-matrix-fig" style="width: 600px">
<img alt="_images/c532f709f96b80da64e34460b58763ea38bcb251253e7c0b8e4541b498b03c39.png" src="_images/c532f709f96b80da64e34460b58763ea38bcb251253e7c0b8e4541b498b03c39.png" />
<figcaption>
<p><span class="caption-number">Fig. 103 </span><span class="caption-text">Variables pour une r√©gression multiple. La variable d√©pendante est la densit√© de mati√®re grise pour un voxel (MG, le voxel de couleur bleu dans <a class="reference internal" href="#vbm-distribution-fig"><span class="std std-numref">Fig. 99</span></a>). Les autres colonnes repr√©sentent les variations de l‚Äô√¢ge, du sexe et de l‚Äôintercept √† travers les sujets (variables pr√©dictives). Les variables pr√©dictives sont g√©n√©ralement repr√©sent√©es de mani√®re plus compacte, sous la forme d‚Äôune image o√π la couleur de chaque pixel repr√©sente l‚Äôintensit√© du r√©gresseur. Le graphique est adapt√© d‚Äôun <a class="reference external" href="https://dartbrains.org/content/GLM.html">code python</a> produit par l‚Äô√©quipe Dartbrains, ainsi que d‚Äôun <a class="reference external" href="https://nilearn.github.io/glm/first_level_model.html">tutoriel nilearn</a> (cliquer sur + pour voir le code). Cette figure est distribu√©e sous licence <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a>.</span><a class="headerlink" href="#design-matrix-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>D‚Äôun point de vue math√©matique, le mod√®le de r√©gression multiple, parfois appel√© mod√®le lin√©aire g√©n√©ral, consiste simplement √† incorporer plus de variables dans la ‚Äúloi‚Äù qui tente de pr√©dire la variable d√©pendante √† partir des r√©gresseurs:
<code class="docutils literal notranslate"><span class="pre">densite_matiere_grise</span> <span class="pre">=</span> <span class="pre">b0</span> <span class="pre">+</span> <span class="pre">b1</span> <span class="pre">*</span> <span class="pre">age</span> <span class="pre">+</span> <span class="pre">b2</span> <span class="pre">*</span> <span class="pre">sexe</span> <span class="pre">+</span> <span class="pre">e</span></code></p>
<p>Le seul nouveau coefficient est <code class="docutils literal notranslate"><span class="pre">b2</span></code>, qui dans ce cas mesure la diff√©rence entre la moyenne de mati√®re grise entre les femelles (cod√©es avec un 0 dans le mod√®le) et les m√¢les (cod√©s avec un 1 dans le mod√®le), <strong>apr√®s un ajustement pour l‚Äô√¢ge des sujets</strong>. Ce type de codage est utilis√© avec les donn√©es cat√©gorielles et est appel√© ‚Äúdummy variable‚Äù en anglais. Il permet d‚Äôint√©grer des tests de diff√©rence de moyenne entre les groupes dans un mod√®le de r√©gression.</p>
<div class="tip admonition" id="stats-regression">
<p class="admonition-title">R√©gression multiple et statistiques classiques</p>
<p>Le mod√®le de r√©gression multiple est tr√®s flexible. Il est possible de formuler la plupart des tests statistiques classiques tels que l‚Äôanalyse de variance (ANOVA) ou bien le test d‚Äô√©galit√© des moyennes de Student (t-test) √† l‚Äôaide du mod√®le de r√©gression lin√©aire. Voir ce <a class="reference external" href="https://lindeloev.github.io/tests-as-linear/">guide</a> pour plus de d√©tails.</p>
</div>
</section>
<section id="id2">
<h3>Cartes statistiques<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">second_level_model</span> <span class="o">=</span> <span class="n">SecondLevelModel</span><span class="p">(</span><span class="n">smoothing_fwhm</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<span class="n">second_level_model</span> <span class="o">=</span> <span class="n">second_level_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">gray_matter_map_filenames</span><span class="p">,</span>
                                            <span class="n">design_matrix</span><span class="o">=</span><span class="n">design_matrix</span><span class="p">)</span>
<span class="n">beta0</span> <span class="o">=</span> <span class="n">second_level_model</span><span class="o">.</span><span class="n">compute_contrast</span><span class="p">(</span><span class="n">second_level_contrast</span><span class="o">=</span><span class="s2">&quot;intercept&quot;</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s2">&quot;effect_size&quot;</span><span class="p">)</span>
<span class="n">beta1</span> <span class="o">=</span> <span class="n">second_level_model</span><span class="o">.</span><span class="n">compute_contrast</span><span class="p">(</span><span class="n">second_level_contrast</span><span class="o">=</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s2">&quot;effect_size&quot;</span><span class="p">)</span>
<span class="n">beta2</span> <span class="o">=</span> <span class="n">second_level_model</span><span class="o">.</span><span class="n">compute_contrast</span><span class="p">(</span><span class="n">second_level_contrast</span><span class="o">=</span><span class="s2">&quot;sexe&quot;</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s2">&quot;effect_size&quot;</span><span class="p">)</span>

<span class="c1"># On g√©n√®re la Figure</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">roi_img</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span>
    <span class="n">beta0</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">gray_matter_map_filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cut_coords</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;intercept (b0)&#39;</span><span class="p">)</span>
<span class="n">roi_img</span><span class="o">.</span><span class="n">add_markers</span><span class="p">([</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">roi_img</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span>
    <span class="n">beta1</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">gray_matter_map_filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cut_coords</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;effet de l</span><span class="se">\&#39;</span><span class="s1">age (b1)&#39;</span><span class="p">)</span>
<span class="n">roi_img</span><span class="o">.</span><span class="n">add_markers</span><span class="p">([</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">roi_img</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span>
    <span class="n">beta2</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">gray_matter_map_filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cut_coords</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;effet du sexe (b2)&#39;</span><span class="p">)</span>
<span class="n">roi_img</span><span class="o">.</span><span class="n">add_markers</span><span class="p">([</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># On colle la figure dans le jupyter book</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;multi-regression-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>           
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="multi-regression-fig" style="width: 800px">
<img alt="_images/38fe404c214dc25ce911d4c8034fe06dddbed6a9a6900ee31eb4f6c1a38a76ab.png" src="_images/38fe404c214dc25ce911d4c8034fe06dddbed6a9a6900ee31eb4f6c1a38a76ab.png" />
<figcaption>
<p><span class="caption-number">Fig. 104 </span><span class="caption-text">Cartes de param√®tres statistiques dans une r√©gression lin√©aire multiple massivement univari√©e. Haut gauche: intercept <code class="docutils literal notranslate"><span class="pre">b0</span></code>, haut droite: effet lin√©aire de l‚Äô√¢ge <code class="docutils literal notranslate"><span class="pre">b1</span></code>, bas gauche: effet lin√©aire du sexe <code class="docutils literal notranslate"><span class="pre">b2</span></code>. Cette figure est adapt√©e d‚Äôun tutoriel de la librairie <a class="reference external" href="https://nilearn.github.io/auto_examples/05_glm_second_level/plot_oasis.html#sphx-glr-auto-examples-05-glm-second-level-plot-oasis-py">nilearn</a> (cliquer sur + pour voir le code). Cette figure est distribu√©e sous licence <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a>.</span><a class="headerlink" href="#multi-regression-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Une caract√©ristique qui peut √™tre l√©g√®rement contre-intuitive avec la r√©gression multiple est que la carte pr√©sentant l‚Äôeffet de l‚Äô√¢ge ici est diff√©rente de celle pr√©sent√©e dans la section portant sur la r√©gression simple. En effet, l‚Äôeffet de l‚Äô√¢ge est maintenant √©valu√© <em>apr√®s avoir pris en compte des diff√©rences de sexe</em>. Malgr√© cela, le r√©sultat de la r√©gression n‚Äôa pas chang√© de mani√®re frappante: le cortex s‚Äôatrophie avec l‚Äô√¢ge (en bleu), alors que le liquide c√©phalo-rachidien s‚Äô√©tend (en rouge). Ce qui appara√Æt comme une expansion de la mati√®re grise refl√®te probablement des effets de volume partiel et des tissus classifi√©s incorrectement comme de la mati√®re grise. L‚Äôanalyse sur la variable <code class="docutils literal notranslate"><span class="pre">sexe</span></code> montre que la densit√© de mati√®re grise est plus √©lev√©e (en moyenne) dans le cortex chez les hommes, alors que la tendance est invers√©e au niveau du cervelet.</p>
</section>
</section>
<section id="tests-statistiques">
<h2>Tests statistiques<a class="headerlink" href="#tests-statistiques" title="Permalink to this heading">#</a></h2>
<section id="tests-t-et-valeur-p">
<h3>Tests t et valeur p<a class="headerlink" href="#tests-t-et-valeur-p" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <span class="n">math_img</span>
<span class="n">z_score</span> <span class="o">=</span> <span class="n">second_level_model</span><span class="o">.</span><span class="n">compute_contrast</span><span class="p">(</span><span class="n">second_level_contrast</span><span class="o">=</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s2">&quot;z_score&quot;</span><span class="p">)</span>
<span class="n">p_value</span> <span class="o">=</span> <span class="n">second_level_model</span><span class="o">.</span><span class="n">compute_contrast</span><span class="p">(</span><span class="n">second_level_contrast</span><span class="o">=</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s2">&quot;p_value&quot;</span><span class="p">)</span>
<span class="n">neg_log_pval</span> <span class="o">=</span> <span class="n">math_img</span><span class="p">(</span><span class="s2">&quot;-np.log10(np.minimum(1, img))&quot;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">p_value</span><span class="p">)</span>

<span class="c1"># On g√©n√®re la Figure</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">roi_img</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span>
    <span class="n">z_score</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">gray_matter_map_filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cut_coords</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;t-test (√¢ge)&#39;</span><span class="p">)</span>
<span class="n">roi_img</span><span class="o">.</span><span class="n">add_markers</span><span class="p">([</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">roi_img</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span>
    <span class="n">neg_log_pval</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">gray_matter_map_filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cut_coords</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;significativit√© (-log10(p))&#39;</span><span class="p">)</span>
<span class="n">roi_img</span><span class="o">.</span><span class="n">add_markers</span><span class="p">([</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># On colle la figure dans le jupyter book</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;tmap-pval-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>           
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="tmap-pval-fig" style="width: 800px">
<img alt="_images/79011f6ffdacd41723fe61ef2172764f35d07ea8b70111246fdd4d7550d05acc.png" src="_images/79011f6ffdacd41723fe61ef2172764f35d07ea8b70111246fdd4d7550d05acc.png" />
<figcaption>
<p><span class="caption-number">Fig. 105 </span><span class="caption-text">Tests statistiques sur la significativit√© de l‚Äôassociation entre densit√© de mati√®re grise et √¢ge. Test t de Student (haut) et log10(p) (bas). Cette figure est adapt√©e d‚Äôun tutoriel de la librairie <a class="reference external" href="https://nilearn.github.io/auto_examples/05_glm_second_level/plot_second_level_one_sample_test.html#sphx-glr-auto-examples-05-glm-second-level-plot-second-level-one-sample-test-py">nilearn</a> (cliquer sur + pour voir le code). Cette figure est distribu√©e sous licence <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a>.</span><a class="headerlink" href="#tmap-pval-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Une fois que l‚Äôon a estim√© l‚Äôeffet de certaines variables explicatives (par exemple, l‚Äô√¢ge) sur notre variable d√©pendante (par exemple, la densit√© de mati√®re grise), il est n√©cessaire de tester la <strong>significativit√©</strong> de cet effet. √Ä cette fin, on utilise l‚Äôamplitude des r√©sidus pour estimer la taille d‚Äôeffet que l‚Äôon pourrait observer par chance, si uniquement ces r√©sidus √©taient pr√©sents. On en d√©duit un test <code class="docutils literal notranslate"><span class="pre">t</span></code> de Student, qui se comporte comme une <a class="reference external" href="https://fr.wikipedia.org/wiki/Loi_normale">loi normale</a> quand le nombre de sujets est grand. Pour chaque voxel, on a donc une statistique <code class="docutils literal notranslate"><span class="pre">t</span></code> diff√©rente, et on peut calculer la probabilit√© <code class="docutils literal notranslate"><span class="pre">p</span></code> d‚Äôobserver cette statistique sous l‚Äô<strong>hypoth√®se nulle</strong>, o√π l‚Äôeffet de la variable explicative est exactement z√©ro.</p>
</section>
<section id="hypothese-nulle">
<h3>Hypoth√®se nulle<a class="headerlink" href="#hypothese-nulle" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">seed</span>
<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">shuffle</span>
<span class="c1"># seed random number generator</span>
<span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">design_rand_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;subject_label&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;femelle&#39;</span><span class="p">,</span> <span class="s1">&#39;male&#39;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">design_rand_matrix</span> <span class="o">=</span> <span class="n">make_second_level_design_matrix</span><span class="p">(</span>
    <span class="n">subject_label</span><span class="p">,</span>
    <span class="n">design_df</span>
    <span class="p">)</span>
<span class="n">shuffle</span><span class="p">(</span><span class="n">design_rand_matrix</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span>

<span class="n">second_level_model_rand</span> <span class="o">=</span> <span class="n">SecondLevelModel</span><span class="p">(</span><span class="n">smoothing_fwhm</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<span class="n">second_level_model_rand</span> <span class="o">=</span> <span class="n">second_level_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">gray_matter_map_filenames</span><span class="p">,</span>
                                            <span class="n">design_matrix</span><span class="o">=</span><span class="n">design_rand_matrix</span><span class="p">)</span>

<span class="n">z_score_rand</span> <span class="o">=</span> <span class="n">second_level_model_rand</span><span class="o">.</span><span class="n">compute_contrast</span><span class="p">(</span><span class="n">second_level_contrast</span><span class="o">=</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s2">&quot;z_score&quot;</span><span class="p">)</span>
<span class="n">p_value_rand</span> <span class="o">=</span> <span class="n">second_level_model_rand</span><span class="o">.</span><span class="n">compute_contrast</span><span class="p">(</span><span class="n">second_level_contrast</span><span class="o">=</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s2">&quot;p_value&quot;</span><span class="p">)</span>
<span class="n">neg_log_pval_rand</span> <span class="o">=</span> <span class="n">math_img</span><span class="p">(</span><span class="s2">&quot;-np.log10(np.minimum(1, img))&quot;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">p_value_rand</span><span class="p">)</span>

<span class="c1"># On g√©n√®re la Figure</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">roi_img</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span>
    <span class="n">z_score_rand</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">gray_matter_map_filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cut_coords</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;t-test (H0)&#39;</span><span class="p">)</span>
<span class="n">roi_img</span><span class="o">.</span><span class="n">add_markers</span><span class="p">([</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">roi_img</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span>
    <span class="n">neg_log_pval_rand</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">gray_matter_map_filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cut_coords</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;significativit√© H0 (-log10(p))&#39;</span><span class="p">)</span>
<span class="n">roi_img</span><span class="o">.</span><span class="n">add_markers</span><span class="p">([</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># On colle la figure dans le jupyter book</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;null-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>           
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="null-fig" style="width: 800px">
<img alt="_images/7d4be7aafbb3c6a8056d6b1ee9b95940b90463eaf5df7f6d199750fff941ac46.png" src="_images/7d4be7aafbb3c6a8056d6b1ee9b95940b90463eaf5df7f6d199750fff941ac46.png" />
<figcaption>
<p><span class="caption-number">Fig. 106 </span><span class="caption-text">Tests statistiques sur la significativit√© de l‚Äôassociation entre densit√© de mati√®re grise et √¢ge, sous l‚Äôhypoth√®se nulle o√π il n‚Äôexiste aucune association. Les donn√©es d‚Äô√¢ge ont √©t√© permut√©es al√©atoirement entre les sujets. Test t de Student (haut) et log10(p) (bas). Cette figure est adapt√©e d‚Äôun tutoriel de la librairie <a class="reference external" href="https://nilearn.github.io/auto_examples/05_glm_second_level/plot_second_level_one_sample_test.html#sphx-glr-auto-examples-05-glm-second-level-plot-second-level-one-sample-test-py">nilearn</a> (cliquer sur + pour voir le code). Cette figure est distribu√©e sous licence <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a>.</span><a class="headerlink" href="#null-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Au coeur de l‚Äôinterpr√©tation de la valeur <code class="docutils literal notranslate"><span class="pre">p</span></code>, il y a ce qu‚Äôon appelle l‚Äô<strong>hypoth√®se nulle</strong>. Pour essayer de comprendre ce que cela veut dire, faisons une exp√©rience. Nous allons recommencer toute la proc√©dure d‚Äôestimation de l‚Äôeffet de l‚Äô√¢ge sur la densit√© de mati√®re grise. Mais cette fois ci, au lieu d‚Äôutiliser l‚Äô√¢ge r√©el des sujets, nous allons m√©langer ces valeurs al√©atoirement (on parle de <a class="reference external" href="https://fr.wikipedia.org/wiki/Permutation">permutations</a>). La distribution des tests <code class="docutils literal notranslate"><span class="pre">t</span></code> et des valeurs <code class="docutils literal notranslate"><span class="pre">p</span></code> est pr√©sent√©e dans la <a class="reference internal" href="#null-fig"><span class="std std-numref">Fig. 106</span></a>. De mani√®re frappante, les valeurs <code class="docutils literal notranslate"><span class="pre">t</span></code> sont beaucoup plus petites avec les valeurs d‚Äô√¢ge al√©atoires que lorsqu‚Äôon a fait l‚Äôanalyse avec les vraies valeurs, mais certaines valeurs restent √©lev√©es. On a r√©alis√© une exp√©rience sous l‚Äôhypoth√®se nulle, o√π il n‚Äôexiste aucune association avec l‚Äô√¢ge. La valeur <code class="docutils literal notranslate"><span class="pre">p</span></code> nous indique la <strong>fr√©quence</strong> avec laquelle on trouvera des valeurs d‚Äôeffet de l‚Äô√¢ge plus √©lev√©es sous l‚Äôhypoth√®se nulle que dans l‚Äô√©chantillon original. Pour estimer cela directement, il faudrait recommencer l‚Äôexp√©rience que l‚Äôon vient de faire avec des milliers de permutations! Mais il existe aussi des m√©thodes approxim√©es plus rapides.</p>
</section>
<section id="comparaisons-multiples">
<h3>Comparaisons multiples<a class="headerlink" href="#comparaisons-multiples" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn.glm</span> <span class="kn">import</span> <span class="n">threshold_stats_img</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="n">p_val</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="n">p001_uncorrected</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span><span class="n">p_val</span><span class="p">)</span>
<span class="n">p_val</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">p05_uncorrected</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span><span class="n">p_val</span><span class="p">)</span>

<span class="c1"># On g√©n√®re la Figure</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">18</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">roi_img</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span>
    <span class="n">z_score</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">p05_uncorrected</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">gray_matter_map_filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cut_coords</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;t-test, p&lt;0.05&#39;</span><span class="p">)</span>
<span class="n">roi_img</span><span class="o">.</span><span class="n">add_markers</span><span class="p">([</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">roi_img</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span>
    <span class="n">z_score</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">p001_uncorrected</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">gray_matter_map_filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cut_coords</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;t-test, p&lt;0.001&#39;</span><span class="p">)</span>
<span class="n">roi_img</span><span class="o">.</span><span class="n">add_markers</span><span class="p">([</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">thresholded_map</span><span class="p">,</span> <span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold_stats_img</span><span class="p">(</span>
    <span class="n">z_score</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span> <span class="n">height_control</span><span class="o">=</span><span class="s1">&#39;bonferroni&#39;</span><span class="p">)</span>
<span class="n">roi_img</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span>
    <span class="n">z_score</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">gray_matter_map_filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cut_coords</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;t-test, p&lt;0.05 corrig√©&#39;</span><span class="p">)</span>
<span class="n">roi_img</span><span class="o">.</span><span class="n">add_markers</span><span class="p">([</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">roi_img</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span>
    <span class="n">z_score_rand</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">p05_uncorrected</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">gray_matter_map_filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cut_coords</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;t-test (H0), p&lt;0.05&#39;</span><span class="p">)</span>
<span class="n">roi_img</span><span class="o">.</span><span class="n">add_markers</span><span class="p">([</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">roi_img</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span>
    <span class="n">z_score_rand</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">p001_uncorrected</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">gray_matter_map_filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cut_coords</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;t-test (H0), p&lt;0.001&#39;</span><span class="p">)</span>
<span class="n">roi_img</span><span class="o">.</span><span class="n">add_markers</span><span class="p">([</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">thresholded_map_rand</span><span class="p">,</span> <span class="n">threshold_rand</span> <span class="o">=</span> <span class="n">threshold_stats_img</span><span class="p">(</span>
    <span class="n">z_score_rand</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span> <span class="n">height_control</span><span class="o">=</span><span class="s1">&#39;bonferroni&#39;</span><span class="p">)</span>
<span class="n">roi_img</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span>
    <span class="n">z_score_rand</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold_rand</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">gray_matter_map_filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cut_coords</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;t-test (H0), p&lt;0.05 corrig√©&#39;</span><span class="p">)</span>
<span class="n">roi_img</span><span class="o">.</span><span class="n">add_markers</span><span class="p">([</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># On colle la figure dans le jupyter book</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;threshold-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>           
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="threshold-fig" style="width: 800px">
<img alt="_images/5ddb2d3c79a40c6cb1ab03795e3071757a24079986215a118c3748da1b81c24f.png" src="_images/5ddb2d3c79a40c6cb1ab03795e3071757a24079986215a118c3748da1b81c24f.png" />
<figcaption>
<p><span class="caption-number">Fig. 107 </span><span class="caption-text">Effet de diff√©rentes strat√©gies de seuillage sur l‚Äôassociation entre l‚Äô√¢ge et la densit√© de mati√®re grise. √Ä gauche: donn√©es sous l‚Äôhypoth√®se nulle (valeurs d‚Äô√¢ge permut√©es au travers des sujets). √Ä droite: donn√©es originales. Ligne 1: seuil <code class="docutils literal notranslate"><span class="pre">p&lt;0.05</span></code> non corrig√© pour les comparaisons multiples; ligne 2: seuil <code class="docutils literal notranslate"><span class="pre">p&lt;0.001</span></code> non corrig√© pour les comparaisons multiples; seuil <code class="docutils literal notranslate"><span class="pre">p&lt;0.05</span></code> corrig√© pour les comparaisons multiples par l‚Äôapproche de Bonferroni. Cette figure est adapt√©e d‚Äôun tutoriel de la librairie <a class="reference external" href="https://nilearn.github.io/auto_examples/05_glm_second_level/plot_thresholding.html#sphx-glr-auto-examples-05-glm-second-level-plot-thresholding-py">nilearn</a> (cliquer sur + pour voir le code). Cette figure est distribu√©e sous licence <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a>.</span><a class="headerlink" href="#threshold-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Maintenant que l‚Äôon a discut√© de l‚Äôinterpr√©tation de la valeur <code class="docutils literal notranslate"><span class="pre">p</span></code>, on doit maintenant d√©cider d‚Äôun seuil √† appliquer sur les valeurs <code class="docutils literal notranslate"><span class="pre">p</span></code>. Si l‚Äôon utilise le seuil habituel <code class="docutils literal notranslate"><span class="pre">p&lt;0.05</span></code>, cela signifie que pour 20 permutations, on d√©tectera une association 1 fois (en moyenne) pour un voxel donn√©. Mais comme on a des milliers de voxels dans le cerveau, cela veut dire que l‚Äôon va d√©tecter 5% du cerveau (en moyenne) pour chaque permutation! C‚Äôest ce que l‚Äôon observe (et m√™me plus) dans la figure en haut √† gauche <a class="reference internal" href="#threshold-fig"><span class="std std-numref">Fig. 107</span></a>. Il s‚Äôagit du <strong>probl√®me de comparaisons multiples</strong>, et plus on fait de tests, plus ce probl√®me est important.</p>
<p>Si l‚Äôon abaisse le seuil √† <code class="docutils literal notranslate"><span class="pre">p&lt;0.001</span></code>, on ne d√©tecte plus que 0.1% du cerveau (en moyenne) sous l‚Äôhypoth√®se nulle, et on observe en effet une r√©duction du nombre de voxels dans la figure de gauche, 2i√®me ligne <a class="reference internal" href="#threshold-fig"><span class="std std-numref">Fig. 107</span></a>.</p>
<p>La m√©thode la plus simple pour corriger du probl√®me de comparaisons multiples est d‚Äôutiliser un seuil corrig√© <code class="docutils literal notranslate"><span class="pre">p&lt;0.05/N</span></code>, o√π N est le nombre de comparaisons (c‚Äôest-√†-dire de tests). Dans notre cas, on a approximativement 100,000 voxels, donc on va utiliser <code class="docutils literal notranslate"><span class="pre">p&lt;0.0000001</span></code>! Avec cette strat√©gie, aucun voxel ne passe le seuil dans notre exp√©rience sous l‚Äôhypoth√®se nulle, voir figure en bas √† gauche <a class="reference internal" href="#threshold-fig"><span class="std std-numref">Fig. 107</span></a>. En g√©n√©ral, c‚Äôest ce qui se passe (en moyenne) pour 19/20 permutations.</p>
<p>Si l‚Äôon observe maintenant l‚Äôeffet de ces diff√©rentes strat√©gies sur les donn√©es originales, on observe que plus le seuil <code class="docutils literal notranslate"><span class="pre">p</span></code> est petit, moins on d√©tecte d‚Äôeffets significatifs. Malgr√© tout, m√™me avec <code class="docutils literal notranslate"><span class="pre">p&lt;0.05</span></code> corrig√© par l‚Äôapproche de Bonferroni, on d√©tecte toujours les effets principaux de l‚Äô√¢ge.</p>
<div class="tip admonition" id="resolution-power">
<p class="admonition-title">Compromis r√©solution / puissance</p>
<p>En r√®gle g√©n√©rale, on doit faire un compromis entre la r√©solution (notre capacit√© √† d√©tecter des effets dans de petites r√©gions du cerveau) et la puissance statistique (notre capacit√© √† d√©tecter des effets de petite taille). Si l‚Äôon veut une excellente r√©solution, on fait des tests √† tous les voxels, mais on doit corriger pour un tr√®s grand nombre de comparaisons multiples. En revanche, si l‚Äôon ne teste qu‚Äôune valeur moyenne sur une r√©gion, on n‚Äôa qu‚Äôun seul test et aucune correction √† appliquer, mais on ne sait pas ce qui se passe dans le reste du cerveau, ou √† l‚Äôint√©rieur de cette r√©gion.</p>
</div>
</section>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Le mod√®le de r√©gression simple permet de pr√©dire les observations d‚Äôune variable d√©pendante √† partir d‚Äôune variable explicative.</p></li>
<li><p>Ce mod√®le est appliqu√© ind√©pendamment √† chaque voxel (approche massivement multivari√©e).</p></li>
<li><p>Il est possible d‚Äôutiliser le mod√®le lin√©aire g√©n√©ral pour tester simultan√©ment l‚Äôeffet de plusieurs variables explicatives sur la variable d√©pendante.</p></li>
<li><p>Quand on effectue un grand nombre de tests statistiques √† chaque voxel, il faut modifier le seuil de significativit√© du test (probl√®me de comparaisons multiples).</p></li>
</ul>
</section>
<section id="exercices">
<h2>Exercices<a class="headerlink" href="#exercices" title="Permalink to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">Exercice 1</p>
<p>Vrai/faux. Le mod√®le de r√©gression g√©n√©ral peut √™tre utilis√© pour effectuer des statistiques de groupe pour les types de mesures suivantes‚Ä¶</p>
<ol class="arabic simple">
<li><p>IRMf</p></li>
<li><p>IRM T1 (VBM)</p></li>
<li><p>IRM T1 (volum√©trie)</p></li>
<li><p>IRM T1 (√©paisseur corticale)</p></li>
<li><p>Tomographie par √©mission de positrons</p></li>
<li><p>Imagerie optique</p></li>
<li><p>Imagerie de diffusion</p></li>
</ol>
</div>
<div class="note admonition">
<p class="admonition-title">Exercice 2</p>
<p>Vrai/faux. La situation suivante inclut un probl√®me de comparaisons multiples en statistique:</p>
<ol class="arabic simple">
<li><p>On effectue de mani√®re r√©p√©t√©e des mesures du volume c√©r√©bral chez N=100 sujets jeunes et N=100 sujets √¢g√©s, puis on compare statistiquement la moyenne des deux groupes.</p></li>
<li><p>On r√©p√®te un test statistique √† chaque voxel dans une image du cerveau, par exemple.</p></li>
<li><p>On acquiert 300 volumes c√©r√©braux chez un individu en IRMf.</p></li>
<li><p>On a quatre sous-groupes, et on compare statistiquement chacune des trois paires possibles de sous-groupes, par exemple.</p></li>
</ol>
</div>
<div class="note admonition">
<p class="admonition-title">Exercice 3</p>
<p>Choisissez la bonne r√©ponse. On observe une diff√©rence de moyenne entre deux groupes, et l‚Äôon effectue un test statistique qui nous donne une valeur p.</p>
<ol class="arabic simple">
<li><p>La valeur p est la probabilit√© de l‚Äôhypoth√®se nulle o√π il n‚Äôexiste pas de vraie diff√©rence.</p></li>
<li><p>Une faible valeur p indique une forte probabilit√© qu‚Äôil y ait une vraie diff√©rence.</p></li>
<li><p>La valeur p indique la probabilit√© d‚Äôobserver cette diff√©rence, au moins, s‚Äôil n‚Äôexistait vraiment aucune diff√©rence entre les deux groupes.</p></li>
</ol>
</div>
<div class="note admonition">
<p class="admonition-title">Exercice 4</p>
<p>On consid√®re les analyses suivantes:
(hippocampe) On compare le volume de l‚Äôhippocampe entre deux groupes de sujets.</p>
<ul class="simple">
<li><p>(VBM) On compare la densit√© de mati√®re grise entre deux groupes de sujets √† chaque voxel du cerveau.</p></li>
<li><p>(atlas) On compare le volume de r√©gions c√©r√©brales entre deux groupes de sujets, √† partir d‚Äôun atlas qui comprend 90 r√©gions.</p></li>
<li><p>(FDG) On compare le m√©tabolisme du glucose entre deux groupes de sujets √† chaque voxel du cerveau, √† l‚Äôaide du FDG-TEP.</p></li>
</ul>
<p>On classe les analyses en fonction du nombre de comparaisons multiples impliqu√©es. Choisissez la bonne r√©ponse:</p>
<ol class="arabic simple">
<li><p>VBM &gt; atlas</p></li>
<li><p>atlas &gt; hippocampe</p></li>
<li><p>atlas &gt; FDG</p></li>
<li><p>R√©ponses 1 et 2.</p></li>
<li><p>R√©ponses 1, 2 et 3.</p></li>
</ol>
</div>
<div class="note admonition">
<p class="admonition-title">Exercice 5</p>
<p>On souhaite comparer la connectivit√© au repos en IRMf √† partir d‚Äôune r√©gion cible dans le cortex cingulaire post√©rieur entre deux groupes de sujets, jeunes vs √¢g√©s. On applique un mod√®le lin√©aire g√©n√©ral √† chaque voxel.</p>
<ul class="simple">
<li><p>D√©crivez les variables pr√©dictives indispensables √† inclure dans ce mod√®le.</p></li>
<li><p>Quelles autres variables vous semblent-elles importantes √† inclure dans le mod√®le?</p></li>
<li><p>Est-ce que ces variables peuvent modifier la diff√©rence observ√©e entre personnes jeunes et √¢g√©es?</p></li>
</ul>
</div>
<div class="note admonition">
<p class="admonition-title">Exercice 6</p>
<p>Pour r√©pondre aux questions de cet exercice, lisez d‚Äôabord l‚Äôarticle <em>Tau pathology in cognitively normal older adults</em> de Ziontz et collaborateurs (disponible comme <a class="reference external" href="https://doi.org/10.1101/611186">preprint</a> sur Biorxiv sous licence CC0). Les questions suivantes requi√®rent des r√©ponses √† d√©veloppement court.</p>
<ul class="simple">
<li><p>Quelle est la variable d√©pendante du mod√®le lin√©aire?</p></li>
<li><p>Quelles variables explicatives sont incluses dans le mod√®le lin√©aire?</p></li>
<li><p>Sait on combien de comparaisons multiples sont faites?</p></li>
<li><p>Comment est-ce que les comparaisons multiples sont corrig√©es?</p></li>
</ul>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="tep.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Tomographie par √©mission de positrons</p>
      </div>
    </a>
    <a class="right-next"
       href="reproductibilite.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Reproductibilit√© et controverses</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objectifs-du-cours">Objectifs du cours</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-lineaire">R√©gression lin√©aire</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variables">Variables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modele-lineaire">Mod√®le lin√©aire</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analyse-massivement-univariee">Analyse massivement univari√©e</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modele-lineaire-general">Mod√®le lin√©aire g√©n√©ral</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Variables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-multiple">R√©gression multiple</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Cartes statistiques</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tests-statistiques">Tests statistiques</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tests-t-et-valeur-p">Tests t et valeur p</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothese-nulle">Hypoth√®se nulle</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparaisons-multiples">Comparaisons multiples</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercices">Exercices</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Pierre Bellec et l'√©quipe PSY3018
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      ¬© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>