
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cartes statistiques &#8212; MÃ©thodes en neurosciences cognitives</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.e8f53015daec13862f6db5e763c41738.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="_static/favicon.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ReproductibilitÃ© et controverses" href="reproductibilite.html" />
    <link rel="prev" title="Imagerie optique" href="imagerie_optique.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">MÃ©thodes en neurosciences cognitives</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="cartes_cerebrales.html">
   Cartes cÃ©rÃ©brales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="irm.html">
   Imagerie par rÃ©sonance magnÃ©tique
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="morphometrie.html">
   Analyses morphomÃ©triques
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="irm_fonctionnelle.html">
   IRM fonctionnelle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="connectivite.html">
   ConnectivitÃ© fonctionnelle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="irm_diffusion.html">
   IRM de diffusion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tep.html">
   Tomographie par Ã©mission de positrons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imagerie_optique.html">
   Imagerie optique
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Cartes statistiques
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reproductibilite.html">
   ReproductibilitÃ© et controverses
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="_sources/cartes_statistiques.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/cartes_statistiques.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/psy3018/notes_cours_psy3018/main?urlpath=tree/methodes_neurocog/cartes_statistiques.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#objectifs-du-cours">
   Objectifs du cours
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regression-lineaire">
   RÃ©gression linÃ©aire
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variables">
     Variables
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regression">
     RÃ©gression
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analyse-massivement-univariee">
     Analyse massivement univariÃ©e
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modele-lineaire-general">
   ModÃ¨le linÃ©aire gÃ©nÃ©ral
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusion">
   Conclusion
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="cartes-statistiques">
<span id="cartes-statistiques-chapitre"></span><h1>Cartes statistiques<a class="headerlink" href="#cartes-statistiques" title="Permalink to this headline">Â¶</a></h1>
<table>
  <tr>
    <td align="center">
      <a href="https://github.com/elisabethloranger">
        <img src="https://avatars.githubusercontent.com/u/90270981?v=4?s=100" width="100px;" alt=""/>
        <br /><sub><b>Ã‰lisabeth Loranger</b></sub>
      </a>
      <br />
        <a title="Contenu">ğŸ¤”</a>
    </td>
    <td align="center">
      <a href="https://github.com/pbellec">
        <img src="https://avatars.githubusercontent.com/u/1670887?v=4?s=100" width="100px;" alt=""/>
        <br /><sub><b>Pierre bellec</b></sub>
      </a>
      <br />
        <a title="Contenu">ğŸ¤”</a>
    </td>
  </tr>
</table>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Ce chapitre est en cours de dÃ©veloppement. Il se peut que lâ€™information soit incomplÃ¨te, ou sujette Ã  changement.</p>
</div>
<div class="section" id="objectifs-du-cours">
<h2>Objectifs du cours<a class="headerlink" href="#objectifs-du-cours" title="Permalink to this headline">Â¶</a></h2>
<p>On va parler du modÃ¨le de rÃ©gression pour gÃ©nÃ©rer des cartes statistiques cÃ©rÃ©brales de groupe. Les statistiques de groupe permettent de combiner les mesures du cerveau de plusieurs individus et ainsi de contraster des groupes (ex. groupe de personnes jeunes et groupe de personnes Ã¢gÃ©es) ou bien de tester lâ€™association avec une variable continue (ex. lâ€™Ã¢ge).</p>
<p>Les objectifs spÃ©cifiques du cours sont les suivants :</p>
<ul class="simple">
<li><p>RÃ©gression linÃ©aire.</p></li>
<li><p>Le modÃ¨le linÃ©aire gÃ©nÃ©ral.</p></li>
<li><p>Comparaisons multiples.</p></li>
</ul>
</div>
<div class="section" id="regression-lineaire">
<h2>RÃ©gression linÃ©aire<a class="headerlink" href="#regression-lineaire" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="variables">
<h3>Variables<a class="headerlink" href="#variables" title="Permalink to this headline">Â¶</a></h3>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importer les librairies</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiMasker</span>
<span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <span class="n">get_data</span>

<span class="c1"># Charge les donnÃ©es</span>
<span class="n">n_subjects</span> <span class="o">=</span> <span class="mi">100</span>  
<span class="n">oasis_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_oasis_vbm</span><span class="p">(</span><span class="n">n_subjects</span><span class="o">=</span><span class="n">n_subjects</span><span class="p">)</span>
<span class="n">gray_matter_map_filenames</span> <span class="o">=</span> <span class="n">oasis_dataset</span><span class="o">.</span><span class="n">gray_matter_maps</span>
<span class="n">age</span> <span class="o">=</span> <span class="n">oasis_dataset</span><span class="o">.</span><span class="n">ext_vars</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sex</span> <span class="o">=</span> <span class="n">oasis_dataset</span><span class="o">.</span><span class="n">ext_vars</span><span class="p">[</span><span class="s1">&#39;mf&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="sa">b</span><span class="s1">&#39;F&#39;</span>

<span class="c1"># On convertit les donnÃ©es en pandas dataframe</span>
<span class="c1"># Deux voxels intÃ©ressants ont Ã©tÃ© sÃ©lectionnÃ©s</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">29.</span><span class="p">,</span>  <span class="mf">10.</span><span class="p">,</span>   <span class="mf">4.</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">19.</span><span class="p">,</span>   <span class="mf">8.</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.</span><span class="p">]])</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;olive&#39;</span><span class="p">]</span>

<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">input_data</span>
<span class="n">masker</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">NiftiSpheresMasker</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
<span class="n">gm</span> <span class="o">=</span> <span class="n">masker</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">gray_matter_map_filenames</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="n">age</span><span class="p">,</span>
    <span class="s2">&quot;sexe&quot;</span><span class="p">:</span> <span class="n">oasis_dataset</span><span class="o">.</span><span class="n">ext_vars</span><span class="p">[</span><span class="s1">&#39;mf&#39;</span><span class="p">],</span>
    <span class="s2">&quot;MG1&quot;</span><span class="p">:</span> <span class="n">gm</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;MG2&quot;</span><span class="p">:</span> <span class="n">gm</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="p">})</span>

<span class="n">df</span><span class="p">[</span><span class="s2">&quot;sexe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;sexe&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="sa">b</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;M&#39;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;femelle&#39;</span><span class="p">,</span> <span class="s1">&#39;male&#39;</span><span class="p">])</span>

<span class="c1"># On gÃ©nÃ¨re la Figure</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>        
    <span class="n">nx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor_divide</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">ny</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">remainder</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">roi_img</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_anat</span><span class="p">(</span>
        <span class="n">gray_matter_map_filenames</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cut_coords</span><span class="o">=</span><span class="p">[</span><span class="n">coords</span><span class="p">[</span><span class="n">nx</span><span class="p">][</span><span class="mi">2</span><span class="p">]],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
        <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">roi_img</span><span class="o">.</span><span class="n">add_markers</span><span class="p">([</span><span class="n">coords</span><span class="p">[</span><span class="n">nx</span><span class="p">]],</span> <span class="n">colors</span><span class="p">[</span><span class="n">nx</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;darkgrid&quot;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;MG1&quot;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">binwidth</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">binrange</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;frequency&#39;</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;MG2&quot;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">binwidth</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">binrange</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;frequency&#39;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;vbm-distribution-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="vbm-distribution-fig" style="width: 800px">
<div class="cell_output docutils container">
<img alt="_images/cartes_statistiques_1_1.png" src="_images/cartes_statistiques_1_1.png" />
</div>
<p class="caption"><span class="caption-number">Fig. 93 </span><span class="caption-text">La position de deux voxels est illustrÃ©e avec un cercle bleu (haut) et vert (bas), de maniÃ¨re superposÃ©e avec des cartes de densitÃ© de matiÃ¨re grise pour diffÃ©rents sujets du jeu de donnÃ©es OASIS (<a class="reference external" href="https://dx.doi.org/10.1162%2Fjocn.2009.21407">Marcus et al., 2010</a>). Ã€ droite, un histograme reprÃ©sente la distribution de la densitÃ© de matiÃ¨re grise pour le voxel correspondant, au travers de 100 sujets. Cette figure est adaptÃ©e dâ€™un tutoriel de la librairie <a class="reference external" href="https://nilearn.github.io/auto_examples/05_glm_second_level/plot_oasis.html#sphx-glr-auto-examples-05-glm-second-level-plot-oasis-py">nilearn</a> (cliquer sur + pour voir le code). Cette figure est distribuÃ©e sous license <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a>.</span><a class="headerlink" href="#vbm-distribution-fig" title="Permalink to this image">Â¶</a></p>
</div>
<p>Les concepts prÃ©sentÃ©s dans ce chapitre sâ€™appliquent Ã  la plupart des modalitÃ©s dâ€™imagerie vues dans le cours de faÃ§on plus ou moins identique. Mais afin de rendre les choses plus concrÃ¨tes, nous allons nous intÃ©resser Ã  une analyse en morphomÃ©trie VBM Ã  lâ€™aide de lâ€™IRM structurelle. Cette analyse utilise le jeu de donnÃ©es OASIS (<a class="reference external" href="https://dx.doi.org/10.1162%2Fjocn.2009.21407">Marcus et al., 2010</a>). Des cartes de densitÃ© de matiÃ¨re grise pour les donnÃ©es OASIS sont disponibles via la librairie <a class="reference external" href="https://nilearn.github.io/modules/generated/nilearn.datasets.fetch_oasis_vbm.html">nilearn</a>. Pour chaque voxel, on dispose dâ€™une mesure locale de densitÃ© de matiÃ¨re grise, qui varie entre 0 et 1. Comme toutes les images des 100 participants OASIS utilisÃ©s dans cet exemple ont Ã©tÃ© recalÃ©es dans un mÃªme espace stÃ©rÃ©otaxique, on a donc pour chaque voxel une sÃ©rie de 100 mesures. Il sâ€™agit de notre <strong>variable dÃ©pendante</strong>, car on va chercher Ã  expliquer les variations de cette mesure au travers des sujets Ã  lâ€™aide dâ€™autres variables, dites <strong>variables indÃ©pendantes</strong>, et on va dÃ©marrer avec lâ€™Ã¢ge des participants.</p>
</div>
<div class="section" id="regression">
<h3>RÃ©gression<a class="headerlink" href="#regression" title="Permalink to this headline">Â¶</a></h3>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># On rÃ©organise de DataFrame pour utiliser seaborn</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="s2">&quot;sexe&quot;</span><span class="p">],</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;MG1&quot;</span><span class="p">,</span> <span class="s2">&quot;MG2&quot;</span><span class="p">],</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;MG&quot;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;MG&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s1">&#39;variable&#39;</span><span class="p">,</span>
           <span class="n">ci</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># On colle la figure dans le jupyter book</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;regression-vbm-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>           
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="regression-vbm-fig" style="width: 800px">
<div class="cell_output docutils container">
<img alt="_images/cartes_statistiques_3_0.png" src="_images/cartes_statistiques_3_0.png" />
</div>
<p class="caption"><span class="caption-number">Fig. 94 </span><span class="caption-text">Cette figure est adaptÃ©e dâ€™un tutoriel de la librairie <a class="reference external" href="https://nilearn.github.io/auto_examples/05_glm_second_level/plot_oasis.html#sphx-glr-auto-examples-05-glm-second-level-plot-oasis-py">nilearn</a> (cliquer sur + pour voir le code). Cette figure est distribuÃ©e sous license <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a>.</span><a class="headerlink" href="#regression-vbm-fig" title="Permalink to this image">Â¶</a></p>
</div>
</div>
<div class="section" id="analyse-massivement-univariee">
<h3>Analyse massivement univariÃ©e<a class="headerlink" href="#analyse-massivement-univariee" title="Permalink to this headline">Â¶</a></h3>
</div>
</div>
<div class="section" id="modele-lineaire-general">
<h2>ModÃ¨le linÃ©aire gÃ©nÃ©ral<a class="headerlink" href="#modele-lineaire-general" title="Permalink to this headline">Â¶</a></h2>
<p>Ici, on a une reprÃ©sentation diffÃ©rente. Cette reprÃ©sentation a lâ€™avantage de permettre de voir plusieurs Â« courbes Â» simultanÃ©ment de maniÃ¨re claire. En mathÃ©matique, on appel ce type de reprÃ©sentation des Â« matrices Â».</p>
<p>On a plusieurs tableaux dans cette reprÃ©sentation. Dans le premier, on a une seule colonne avec plein de lignes, ensuite on a un tableau qui a le mÃªme nombre de lignes que le premier mais avec 4 colonnes et un dernier tableau avec seulement 3 lignes et une colonne. Dans les deux premiers tableaux, chaque ligne correspond Ã  un sujet et chaque colonne correspond Ã  un type de variable. Il faut prÃ©ciser que lâ€™on nâ€™a pas pris le scan cÃ©rÃ©bral complet pour le premier tableau. En fait, on a pris le mÃªme voxel chez tous les participants (Ã  lâ€™aide dâ€™un recalage).</p>
<p>Les tons de gris reprÃ©sentent en fait des valeurs numÃ©riques. Or, pour aider Ã  la visualisation, nous avons utilisÃ© une Ã©chelle de couleurs qui reprÃ©sente ces valeurs.</p>
<p>Le premier tableau reprÃ©sente les valeurs des cartes cÃ©rÃ©brales, qui sont les valeurs que lâ€™on cherche Ã  expliquer. Les tableaux Ã  droite du Â« = Â» reprÃ©sentent les valeurs qui permettent dâ€™expliquer les valeurs des cartes cÃ©rÃ©brales.
Ici, on a deux vecteurs qui cotent pour le sexe de nos participants et un autre qui reprÃ©sente le score de dÃ©pression pour chacune de nos observations (dans le premier tableau).</p>
<p>Cette reprÃ©sentation est plutÃ´t simple, nous avons une formule ressemblant Ã  y = mx+b, donnant une relation linÃ©aire. Ã€ gauche on a le y, câ€™est ce quâ€™on cherche Ã  modÃ©liser. Le tableau Ã  droite, on a les paramÃ¨tres explicatifs. Pour le sexe, on a mis un 1 quand le sexe correspondait au sujet et un 0 lorsquâ€™il ne correspondait pas. Ainsi, on remarque que, ici, la moitiÃ© des sujets Ã©taient des hommes et lâ€™autre moitiÃ© Ã©taient des femmes. La variable de dÃ©pression est mesurÃ©e Ã  lâ€™aide de questionnaires et le score est reprÃ©sentÃ© ici dans la 3e colonne du 2e tableau. Le 3e tableau reprÃ©sente lâ€™amplitude des diffÃ©rentes facteurs explicatifs que lâ€™on peut changer afin de mieux expliquer nos valeurs IRMf. Ceci revient Ã  la mÃªme chose qui a Ã©tÃ© vue dans les graphiques prÃ©sentÃ©s plus tÃ´t. Ainsi, le score que lâ€™on tente dâ€™expliquer pour un sujet (une ligne) sera obtenu Ã  lâ€™aide de la formule suivante : le score Â« homme Â» du sujet x le coefficient Â« homme Â» + le score Â« femme Â» du sujet x le coefficient Â« femme Â» + le score Â« dÃ©pression Â» du sujet x le coefficient Â« dÃ©pression Â». Ce qui reste et qui n,est pas expliquÃ© par cette formule correspondra aux rÃ©sidus. Tel que vu plus tÃ´t, la formule avec les coefficients auront comme but de minimiser les rÃ©sidus le plus possible.</p>
<p>Ici, on a un exemple un peu plus complexe. Ã€ gauche, on a ce quâ€™on vient de voir et au centre, on a sÃ©parÃ© le score de dÃ©pression pour les femmes et celui pour les hommes.</p>
<p>Dans lâ€™exemple prÃ©cÃ©dent, le coefficient de dÃ©pression Ã©tait le mÃªme pour les hommes et les femmes. On prÃ©tendait alors que le niveau dâ€™influence de la dÃ©pression sur le cerveau des femmes et celui des hommes Ã©tait pareil. Dans le tableau du centre, nous attribuions un coefficient diffÃ©rent aux scores de dÃ©pression des hommes et celui des femmes, prÃ©tendant alors que lâ€™influence de la dÃ©pression sur le cerveau pourrait diffÃ©rer en fonction du sexe. Ici, on test alors le principe dâ€™interaction. En statistiques classiques, on pourrait comparer ce modÃ¨le a une ANOVA.</p>
<p>En rÃ©alitÃ©, ce modÃ¨le se nomme le modÃ¨le linÃ©aire gÃ©nÃ©ral car on peut pas mal tout tester. Si on veut faire un test-t, on peut le faire Ã  lâ€™aide de ce modÃ¨le.</p>
<p>Si on prend deux coefficients de notre modÃ¨le, on peut regarder la diffÃ©rence entre ces deux coefficients. Par exemple, on peut regarder si lâ€™influence de la dÃ©pression sur le cerveau chez les femmes (ÃŸ1) diffÃ¨re de celle de la dÃ©pression sur le cerveau chez les hommes (ÃŸ2).</p>
<p>Ca donnerait quelque chose comme Ã§a et nous donnerait une carte de contraste statistique qui nous permet de contraster lâ€™influence de la dÃ©pression chez les femmes et chez les hommes.
Ce qui va changer dâ€™un voxel Ã  lâ€™autre ce nâ€™est pas les facteurs explicatifs, ce sont les y (les mesures dâ€™activation). On nâ€™aura ainsi pas les mÃªmes bÃªtas et les mÃªmes valeurs de contraste. Câ€™est aussi appelÃ© une approche massivement univariÃ©e.</p>
<p>On peut parler dâ€™une analyse de niveau 1 pour les analyses individuelles et les analyses de niveau 2 pour les analyses de groupe.</p>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">Â¶</a></h2>
<p>En gÃ©nÃ©rale quand on parle de lâ€™IRMf ou mÃªme de la VBM, on trouve des blobs qui prÃ©sentent des effets significatifs. Ce qui est important de se rappeler est toute la sÃ©rie dâ€™Ã©tapes qui mÃ¨nent Ã  ce type de carte.</p>
<ol class="simple">
<li><p>La premiÃ¨re, lâ€™hypothÃ¨se psychologique : 	On avait commencÃ© le cours avec ces deux tÃ¢ches avec les visages qui expriment les Ã©motions et des stimuli contrÃ´les. Notre est hypothÃ¨se est que ce sont les visages qui expliquent le patron dâ€™activation observÃ©.</p></li>
<li><p>Ensuite, on a des hypothÃ¨ses au niveau neuronal : On Ã©met des hypothÃ¨ses au sujet du type de rÃ©ponse neuronale observÃ©. En IRMf, on Ã©met lâ€™hypothÃ¨se que lâ€™activation atteint son plafond quand la stimulation est dÃ©butÃ©e et quâ€™elle retombe Ã  0 une fois le bloc terminÃ©.</p></li>
<li><p>Finalement, on a des hypothÃ¨ses hÃ©modynamiques : On va supposer que lâ€™activitÃ© BOLD enregistrÃ©e en IRMf va correspondre Ã  lâ€™activitÃ© neuronale.</p></li>
</ol>
<p>Ã€ la fin, on aura des Ã©tapes dâ€™analyses dâ€™images, de recalage, de dÃ©bruitage et de modÃ©lisation statistique.</p>
<p>Ainsi, il y a beaucoup de choses, de choix et dâ€™hypothÃ¨ses qui vont derriÃ¨re ce petit blob rouge qui ressort dans des cartes statistiques.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="imagerie_optique.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Imagerie optique</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="reproductibilite.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">ReproductibilitÃ© et controverses</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Pierre Bellec et l'Ã©quipe PSY3018<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>